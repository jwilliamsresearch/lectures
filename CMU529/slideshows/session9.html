<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Session 9: E-commerce Core Features</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/theme/white.css">
    <style>
        .reveal .slides section {
            text-align: left;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
            max-height: 100vh;
        }
        .reveal .slides section.center { text-align: center; }
        .reveal .slides section h1 { font-size: 2.5em; margin-bottom: 0.5em; }
        .reveal .slides section h2 { font-size: 2em; margin-bottom: 0.5em; }
        .reveal .slides section h3 { font-size: 1.5em; margin-bottom: 0.5em; }
        .reveal .slides section p { font-size: 1.1em; line-height: 1.4; margin-bottom: 0.8em; }
        .reveal .slides section ul, .reveal .slides section ol { font-size: 1em; line-height: 1.4; margin-bottom: 0.8em; }
        .reveal .slides section li { margin-bottom: 0.3em; }
        .task-box {
            background: #fff5f5;
            border: 2px solid #ff6b6b;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            max-height: 60vh;
            overflow-y: auto;
        }
        .code-example {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            font-size: 0.9em;
            line-height: 1.3;
            max-height: 40vh;
            overflow-y: auto;
        }
        .highlight {
            background: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
            margin: 10px 0;
        }
        .timeline-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-size: 0.9em;
        }
        .timeline-info ul { margin: 10px 0; padding-left: 20px; }
        .timeline-info li { margin-bottom: 0.2em; }
        .diagram {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        @media (max-width: 768px) {
            .reveal .slides section { padding: 15px; }
            .reveal .slides section h1 { font-size: 2em; }
            .reveal .slides section h2 { font-size: 1.6em; }
            .reveal .slides section h3 { font-size: 1.3em; }
            .task-box, .code-example { font-size: 0.9em; padding: 15px; }
        }
        
        /* Custom scrollbar styling */
        .reveal .slides section::-webkit-scrollbar,
        .task-box::-webkit-scrollbar,
        .code-example::-webkit-scrollbar {
            width: 8px;
        }
        
        .reveal .slides section::-webkit-scrollbar-track,
        .task-box::-webkit-scrollbar-track,
        .code-example::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .reveal .slides section::-webkit-scrollbar-thumb,
        .task-box::-webkit-scrollbar-thumb,
        .code-example::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        
        .reveal .slides section::-webkit-scrollbar-thumb:hover,
        .task-box::-webkit-scrollbar-thumb:hover,
        .code-example::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
    </style>
</head>
<body>
    <div style="position: fixed; top: 20px; left: 20px; z-index: 1000;">
        <a href="../index.html" style="
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            transition: all 0.3s ease;
            display: inline-block;
        " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(255, 107, 107, 0.4)'" 
           onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(255, 107, 107, 0.3)'">
            ← Back to Module
        </a>
    </div>
    <div class="reveal">
        <div class="slides">
            <!-- Slide 1: Title -->
            <section class="center">
                <h1>E-commerce Core Features</h1>
                <h3>CMU529: Advanced Web Development - Session 9</h3>
                <p><strong>Birmingham Newman University</strong></p>
                <p><em>Lecturer: James Williams</em></p>
                <p>Product catalogues, shopping cart implementation, and order management systems</p>
                <p><small>3-hour session • 22 slides • 2 interactive tasks</small></p>
                <div class="timeline-info">
                    <p><strong>Session Timeline:</strong></p>
                    <ul>
                        <li>10 min: Registration & waiting</li>
                        <li>20 min: Opening slides</li>
                        <li>45 min: Task 1</li>
                        <li>15 min: Break/Catch up</li>
                        <li>20 min: Secondary slides</li>
                        <li>45 min: Task 2</li>
                        <li>Remaining: Self-study</li>
                    </ul>
                </div>
            </section>

            <!-- Slide 2: Learning Objectives -->
            <section>
                <h2>Learning Objectives</h2>
                <ul>
                    <li>Build product catalogue systems</li>
                    <li>Implement shopping cart functionality</li>
                    <li>Create order management systems</li>
                    <li>Handle inventory management</li>
                    <li>Build checkout processes</li>
                </ul>
            </section>

            <!-- Slide 3: Product Catalogue -->
            <section>
                <h2>Product Catalogue</h2>
                <div class="code-example">
                    Product Display System:<br><br>
                    
                    // Get products with pagination<br>
                    $page = isset($_GET['page']) ? (int)$_GET['page'] : 1;<br>
                    $limit = 12;<br>
                    $offset = ($page - 1) * $limit;<br><br>
                    
                    $stmt = $pdo->prepare("SELECT * FROM products WHERE active = 1 ORDER BY created_at DESC LIMIT ? OFFSET ?");<br>
                    $stmt->execute([$limit, $offset]);<br>
                    $products = $stmt->fetchAll();<br><br>
                    
                    // Display products<br>
                    foreach ($products as $product) {<br>
                    &nbsp;&nbsp;echo "&lt;div class='product-card'&gt;";<br>
                    &nbsp;&nbsp;echo "&lt;img src='" . $product['image'] . "' alt='" . $product['name'] . "'&gt;";<br>
                    &nbsp;&nbsp;echo "&lt;h3&gt;" . $product['name'] . "&lt;/h3&gt;";<br>
                    &nbsp;&nbsp;echo "&lt;p&gt;$" . number_format($product['price'], 2) . "&lt;/p&gt;";<br>
                    &nbsp;&nbsp;echo "&lt;button onclick='addToCart(" . $product['id'] . ")&gt;Add to Cart&lt;/button&gt;";<br>
                    &nbsp;&nbsp;echo "&lt;/div&gt;";<br>
                    }
                </div>
                <ul>
                    <li>Display products with pagination</li>
                    <li>Show product images and details</li>
                    <li>Add to cart functionality</li>
                </ul>
            </section>

            <!-- Slide 4: Product Categories -->
            <section>
                <h2>Product Categories</h2>
                <div class="code-example">
                    Category System:<br><br>
                    
                    // Get categories<br>
                    $stmt = $pdo->query("SELECT * FROM categories ORDER BY name");<br>
                    $categories = $stmt->fetchAll();<br><br>
                    
                    // Display category menu<br>
                    echo "&lt;div class='category-menu'&gt;";<br>
                    foreach ($categories as $category) {<br>
                    &nbsp;&nbsp;echo "&lt;a href='?category=" . $category['id'] . "'&gt;" . $category['name'] . "&lt;/a&gt;";<br>
                    }<br>
                    echo "&lt;/div&gt;";<br><br>
                    
                    // Filter by category<br>
                    if (isset($_GET['category'])) {<br>
                    &nbsp;&nbsp;$categoryId = (int)$_GET['category'];<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("SELECT * FROM products WHERE category_id = ? AND active = 1");<br>
                    &nbsp;&nbsp;$stmt->execute([$categoryId]);<br>
                    &nbsp;&nbsp;$products = $stmt->fetchAll();<br>
                    }
                </div>
                <ul>
                    <li>Organize products by categories</li>
                    <li>Filter products by category</li>
                    <li>Create category navigation</li>
                </ul>
            </section>

            <!-- Slide 5: Shopping Cart -->
            <section>
                <h2>Shopping Cart</h2>
                <div class="code-example">
                    Cart Implementation:<br><br>
                    
                    // Add to cart<br>
                    function addToCart($productId, $quantity = 1) {<br>
                    &nbsp;&nbsp;if (!isset($_SESSION['cart'])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$_SESSION['cart'] = [];<br>
                    &nbsp;&nbsp;}<br><br>
                    
                    &nbsp;&nbsp;if (isset($_SESSION['cart'][$productId])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$_SESSION['cart'][$productId] += $quantity;<br>
                    &nbsp;&nbsp;} else {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$_SESSION['cart'][$productId] = $quantity;<br>
                    &nbsp;&nbsp;}<br>
                    }<br><br>
                    
                    // Get cart items<br>
                    function getCartItems() {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$cartItems = [];<br><br>
                    
                    &nbsp;&nbsp;if (isset($_SESSION['cart'])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$productIds = array_keys($_SESSION['cart']);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$placeholders = str_repeat('?,', count($productIds) - 1) . '?';<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$stmt = $pdo->prepare("SELECT * FROM products WHERE id IN ($placeholders)");<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$stmt->execute($productIds);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$products = $stmt->fetchAll();<br><br>
                    
                    &nbsp;&nbsp;&nbsp;&nbsp;foreach ($products as $product) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cartItems[] = [<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'product' => $product,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'quantity' => $_SESSION['cart'][$product['id']]<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    &nbsp;&nbsp;}<br><br>
                    
                    &nbsp;&nbsp;return $cartItems;<br>
                    }
                </div>
                <ul>
                    <li>Store cart in session</li>
                    <li>Add/remove items</li>
                    <li>Calculate totals</li>
                </ul>
            </section>

            <!-- Slide 6: Cart Management -->
            <section>
                <h2>Cart Management</h2>
                <div class="code-example">
                    Cart Operations:<br><br>
                    
                    // Update cart quantity<br>
                    function updateCartQuantity($productId, $quantity) {<br>
                    &nbsp;&nbsp;if ($quantity <= 0) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;unset($_SESSION['cart'][$productId]);<br>
                    &nbsp;&nbsp;} else {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$_SESSION['cart'][$productId] = $quantity;<br>
                    &nbsp;&nbsp;}<br>
                    }<br><br>
                    
                    // Remove from cart<br>
                    function removeFromCart($productId) {<br>
                    &nbsp;&nbsp;unset($_SESSION['cart'][$productId]);<br>
                    }<br><br>
                    
                    // Clear cart<br>
                    function clearCart() {<br>
                    &nbsp;&nbsp;$_SESSION['cart'] = [];<br>
                    }<br><br>
                    
                    // Get cart total<br>
                    function getCartTotal() {<br>
                    &nbsp;&nbsp;$cartItems = getCartItems();<br>
                    &nbsp;&nbsp;$total = 0;<br><br>
                    
                    &nbsp;&nbsp;foreach ($cartItems as $item) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$total += $item['product']['price'] * $item['quantity'];<br>
                    &nbsp;&nbsp;}<br><br>
                    
                    &nbsp;&nbsp;return $total;<br>
                    }
                </div>
                <ul>
                    <li>Update item quantities</li>
                    <li>Remove items from cart</li>
                    <li>Calculate cart totals</li>
                </ul>
            </section>

            <!-- Slide 7: Checkout Process -->
            <section>
                <h2>Checkout Process</h2>
                <div class="code-example">
                    Checkout System:<br><br>
                    
                    // Process checkout<br>
                    if ($_SERVER["REQUEST_METHOD"] == "POST") {<br>
                    &nbsp;&nbsp;$userId = $_SESSION['user_id'];<br>
                    &nbsp;&nbsp;$cartItems = getCartItems();<br>
                    &nbsp;&nbsp;$total = getCartTotal();<br><br>
                    
                    &nbsp;&nbsp;try {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$pdo->beginTransaction();<br><br>
                    
                    &nbsp;&nbsp;&nbsp;&nbsp;// Create order<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$stmt = $pdo->prepare("INSERT INTO orders (user_id, total, status) VALUES (?, ?, 'pending')");<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$stmt->execute([$userId, $total]);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$orderId = $pdo->lastInsertId();<br><br>
                    
                    &nbsp;&nbsp;&nbsp;&nbsp;// Add order items<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;foreach ($cartItems as $item) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$stmt = $pdo->prepare("INSERT INTO order_items (order_id, product_id, quantity, price) VALUES (?, ?, ?, ?)");<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$stmt->execute([$orderId, $item['product']['id'], $item['quantity'], $item['product']['price']]);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br><br>
                    
                    &nbsp;&nbsp;&nbsp;&nbsp;$pdo->commit();<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;clearCart();<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;echo "Order placed successfully!";<br>
                    } catch(PDOException $e) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$pdo->rollback();<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;echo "Order failed: " . $e->getMessage();<br>
                    &nbsp;&nbsp;}<br>
                    }
                </div>
                <ul>
                    <li>Create orders in database</li>
                    <li>Use transactions for data integrity</li>
                    <li>Clear cart after successful order</li>
                </ul>
            </section>

            <!-- Slide 8: Order Management -->
            <section>
                <h2>Order Management</h2>
                <div class="code-example">
                    Order System:<br><br>
                    
                    // Get user orders<br>
                    function getUserOrders($userId) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("SELECT * FROM orders WHERE user_id = ? ORDER BY created_at DESC");<br>
                    &nbsp;&nbsp;$stmt->execute([$userId]);<br>
                    &nbsp;&nbsp;return $stmt->fetchAll();<br>
                    }<br><br>
                    
                    // Get order details<br>
                    function getOrderDetails($orderId) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("SELECT oi.*, p.name, p.image FROM order_items oi JOIN products p ON oi.product_id = p.id WHERE oi.order_id = ?");<br>
                    &nbsp;&nbsp;$stmt->execute([$orderId]);<br>
                    &nbsp;&nbsp;return $stmt->fetchAll();<br>
                    }<br><br>
                    
                    // Update order status<br>
                    function updateOrderStatus($orderId, $status) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("UPDATE orders SET status = ? WHERE id = ?");<br>
                    &nbsp;&nbsp;$stmt->execute([$status, $orderId]);<br>
                    }
                </div>
                <ul>
                    <li>Track order status</li>
                    <li>View order history</li>
                    <li>Manage order details</li>
                </ul>
            </section>

            <!-- Slide 9: Inventory Management -->
            <section>
                <h2>Inventory Management</h2>
                <div class="code-example">
                    Stock Control:<br><br>
                    
                    // Check stock availability<br>
                    function checkStock($productId, $quantity) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("SELECT stock FROM products WHERE id = ?");<br>
                    &nbsp;&nbsp;$stmt->execute([$productId]);<br>
                    &nbsp;&nbsp;$product = $stmt->fetch();<br><br>
                    
                    &nbsp;&nbsp;return $product['stock'] >= $quantity;<br>
                    }<br><br>
                    
                    // Update stock<br>
                    function updateStock($productId, $quantity) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("UPDATE products SET stock = stock - ? WHERE id = ?");<br>
                    &nbsp;&nbsp;$stmt->execute([$quantity, $productId]);<br>
                    }<br><br>
                    
                    // Check stock before checkout<br>
                    $cartItems = getCartItems();<br>
                    foreach ($cartItems as $item) {<br>
                    &nbsp;&nbsp;if (!checkStock($item['product']['id'], $item['quantity'])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;echo "Insufficient stock for " . $item['product']['name'];<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;exit();<br>
                    &nbsp;&nbsp;}<br>
                    }
                </div>
                <ul>
                    <li>Check stock availability</li>
                    <li>Update inventory levels</li>
                    <li>Prevent overselling</li>
                </ul>
            </section>

            <!-- Slide 10: Product Search -->
            <section>
                <h2>Product Search</h2>
                <div class="code-example">
                    Search Functionality:<br><br>
                    
                    // Search products<br>
                    function searchProducts($query, $category = null) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$searchTerm = "%$query%";<br><br>
                    
                    &nbsp;&nbsp;if ($category) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$stmt = $pdo->prepare("SELECT * FROM products WHERE (name LIKE ? OR description LIKE ?) AND category_id = ? AND active = 1");<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$stmt->execute([$searchTerm, $searchTerm, $category]);<br>
                    &nbsp;&nbsp;} else {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$stmt = $pdo->prepare("SELECT * FROM products WHERE (name LIKE ? OR description LIKE ?) AND active = 1");<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$stmt->execute([$searchTerm, $searchTerm]);<br>
                    &nbsp;&nbsp;}<br><br>
                    
                    &nbsp;&nbsp;return $stmt->fetchAll();<br>
                    }<br><br>
                    
                    // Handle search form<br>
                    if (isset($_GET['search'])) {<br>
                    &nbsp;&nbsp;$searchQuery = trim($_GET['search']);<br>
                    &nbsp;&nbsp;$category = isset($_GET['category']) ? (int)$_GET['category'] : null;<br>
                    &nbsp;&nbsp;$products = searchProducts($searchQuery, $category);<br>
                    }
                </div>
                <ul>
                    <li>Search by product name</li>
                    <li>Search by description</li>
                    <li>Filter by category</li>
                </ul>
            </section>

            <!-- Slide 11: TASK 1 - Halfway Point -->
            <section class="center">
                <h2>Task 1: Basic E-commerce System</h2>
                <div class="task-box">
                    <h3>Instructions:</h3>
                    <ol>
                        <li>Create a basic e-commerce system with:</li>
                        <ul>
                            <li>Product catalogue with categories</li>
                            <li>Shopping cart functionality</li>
                            <li>Add/remove items from cart</li>
                            <li>Checkout process</li>
                            <li>Order management system</li>
                        </ul>
                        <li>Implement inventory management</li>
                        <li>Add product search functionality</li>
                        <li>Create order history for users</li>
                        <li>Test all e-commerce features</li>
                    </ol>
                    <p><strong>Time:</strong> 45 minutes</p>
                    <p><em>This task will help you build core e-commerce functionality</em></p>
                </div>
            </section>

            <!-- Slide 12: Break/Catch Up -->
            <section class="center">
                <h2>Break Time</h2>
                <div class="highlight">
                    <h3>15 Minutes</h3>
                    <p>Take a break, ask questions, or catch up on the previous task.</p>
                    <p><em>Next: Secondary slides and Task 2</em></p>
                </div>
            </section>

            <!-- Slide 13: Product Reviews -->
            <section>
                <h2>Product Reviews</h2>
                <div class="code-example">
                    Review System:<br><br>
                    
                    // Add product review<br>
                    function addReview($productId, $userId, $rating, $comment) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("INSERT INTO reviews (product_id, user_id, rating, comment, created_at) VALUES (?, ?, ?, ?, NOW())");<br>
                    &nbsp;&nbsp;$stmt->execute([$productId, $userId, $rating, $comment]);<br><br>
                    
                    &nbsp;&nbsp;// Update product average rating<br>
                    &nbsp;&nbsp;updateProductRating($productId);<br>
                    }<br><br>
                    
                    // Get product reviews<br>
                    function getProductReviews($productId) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("SELECT r.*, u.username FROM reviews r JOIN users u ON r.user_id = u.id WHERE r.product_id = ? ORDER BY r.created_at DESC");<br>
                    &nbsp;&nbsp;$stmt->execute([$productId]);<br>
                    &nbsp;&nbsp;return $stmt->fetchAll();<br>
                    }<br><br>
                    
                    // Update product rating<br>
                    function updateProductRating($productId) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("UPDATE products SET avg_rating = (SELECT AVG(rating) FROM reviews WHERE product_id = ?) WHERE id = ?");<br>
                    &nbsp;&nbsp;$stmt->execute([$productId, $productId]);<br>
                    }
                </div>
            </section>

            <!-- Slide 14: Wishlist -->
            <section>
                <h2>Wishlist System</h2>
                <div class="code-example">
                    Wishlist Management:<br><br>
                    
                    // Add to wishlist<br>
                    function addToWishlist($userId, $productId) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("INSERT IGNORE INTO wishlist (user_id, product_id, created_at) VALUES (?, ?, NOW())");<br>
                    &nbsp;&nbsp;$stmt->execute([$userId, $productId]);<br>
                    }<br><br>
                    
                    // Get user wishlist<br>
                    function getWishlist($userId) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("SELECT p.* FROM wishlist w JOIN products p ON w.product_id = p.id WHERE w.user_id = ? ORDER BY w.created_at DESC");<br>
                    &nbsp;&nbsp;$stmt->execute([$userId]);<br>
                    &nbsp;&nbsp;return $stmt->fetchAll();<br>
                    }<br><br>
                    
                    // Remove from wishlist<br>
                    function removeFromWishlist($userId, $productId) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("DELETE FROM wishlist WHERE user_id = ? AND product_id = ?");<br>
                    &nbsp;&nbsp;$stmt->execute([$userId, $productId]);<br>
                    }
                </div>
            </section>

            <!-- Slide 15: Discount System -->
            <section>
                <h2>Discount System</h2>
                <div class="code-example">
                    Coupon Management:<br><br>
                    
                    // Apply discount<br>
                    function applyDiscount($code, $total) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("SELECT * FROM coupons WHERE code = ? AND active = 1 AND expires_at > NOW()");<br>
                    &nbsp;&nbsp;$stmt->execute([$code]);<br>
                    &nbsp;&nbsp;$coupon = $stmt->fetch();<br><br>
                    
                    &nbsp;&nbsp;if ($coupon) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;if ($coupon['type'] == 'percentage') {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$discount = $total * ($coupon['value'] / 100);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;} else {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$discount = $coupon['value'];<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;return min($discount, $total);<br>
                    &nbsp;&nbsp;}<br><br>
                    
                    &nbsp;&nbsp;return 0;<br>
                    }<br><br>
                    
                    // Calculate final total<br>
                    $subtotal = getCartTotal();<br>
                    $discount = applyDiscount($_POST['coupon_code'], $subtotal);<br>
                    $finalTotal = $subtotal - $discount;
                </div>
            </section>

            <!-- Slide 16: Shipping Calculator -->
            <section>
                <h2>Shipping Calculator</h2>
                <div class="code-example">
                    Shipping System:<br><br>
                    
                    // Calculate shipping cost<br>
                    function calculateShipping($weight, $destination) {<br>
                    &nbsp;&nbsp;$baseCost = 5.00;<br>
                    &nbsp;&nbsp;$perKg = 2.00;<br><br>
                    
                    &nbsp;&nbsp;$shippingCost = $baseCost + ($weight * $perKg);<br><br>
                    
                    &nbsp;&nbsp;// Add destination surcharge<br>
                    &nbsp;&nbsp;switch ($destination) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;case 'international':<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$shippingCost += 15.00;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;case 'remote':<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$shippingCost += 8.00;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br>
                    &nbsp;&nbsp;}<br><br>
                    
                    &nbsp;&nbsp;return $shippingCost;<br>
                    }<br><br>
                    
                    // Get cart weight<br>
                    function getCartWeight() {<br>
                    &nbsp;&nbsp;$cartItems = getCartItems();<br>
                    &nbsp;&nbsp;$totalWeight = 0;<br><br>
                    
                    &nbsp;&nbsp;foreach ($cartItems as $item) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$totalWeight += $item['product']['weight'] * $item['quantity'];<br>
                    &nbsp;&nbsp;}<br><br>
                    
                    &nbsp;&nbsp;return $totalWeight;<br>
                    }
                </div>
            </section>

            <!-- Slide 17: Order Tracking -->
            <section>
                <h2>Order Tracking</h2>
                <div class="code-example">
                    Tracking System:<br><br>
                    
                    // Generate tracking number<br>
                    function generateTrackingNumber() {<br>
                    &nbsp;&nbsp;return 'TRK' . date('Ymd') . strtoupper(substr(md5(uniqid()), 0, 8));<br>
                    }<br><br>
                    
                    // Update order status<br>
                    function updateOrderStatus($orderId, $status, $trackingNumber = null) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("UPDATE orders SET status = ?, tracking_number = ?, updated_at = NOW() WHERE id = ?");<br>
                    &nbsp;&nbsp;$stmt->execute([$status, $trackingNumber, $orderId]);<br><br>
                    
                    &nbsp;&nbsp;// Log status change<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("INSERT INTO order_status_log (order_id, status, created_at) VALUES (?, ?, NOW())");<br>
                    &nbsp;&nbsp;$stmt->execute([$orderId, $status]);<br>
                    }<br><br>
                    
                    // Get order status history<br>
                    function getOrderStatusHistory($orderId) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("SELECT * FROM order_status_log WHERE order_id = ? ORDER BY created_at DESC");<br>
                    &nbsp;&nbsp;$stmt->execute([$orderId]);<br>
                    &nbsp;&nbsp;return $stmt->fetchAll();<br>
                    }
                </div>
            </section>

            <!-- Slide 18: Email Notifications -->
            <section>
                <h2>Email Notifications</h2>
                <div class="code-example">
                    Email System:<br><br>
                    
                    // Send order confirmation<br>
                    function sendOrderConfirmation($orderId) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("SELECT o.*, u.email, u.username FROM orders o JOIN users u ON o.user_id = u.id WHERE o.id = ?");<br>
                    &nbsp;&nbsp;$stmt->execute([$orderId]);<br>
                    &nbsp;&nbsp;$order = $stmt->fetch();<br><br>
                    
                    &nbsp;&nbsp;$to = $order['email'];<br>
                    &nbsp;&nbsp;$subject = "Order Confirmation #" . $orderId;<br>
                    &nbsp;&nbsp;$message = "Dear " . $order['username'] . ",\n\n";<br>
                    &nbsp;&nbsp;$message .= "Your order has been confirmed.\n";<br>
                    &nbsp;&nbsp;$message .= "Order ID: " . $orderId . "\n";<br>
                    &nbsp;&nbsp;$message .= "Total: $" . number_format($order['total'], 2) . "\n\n";<br>
                    &nbsp;&nbsp;$message .= "Thank you for your purchase!";<br><br>
                    
                    &nbsp;&nbsp;mail($to, $subject, $message);<br>
                    }<br><br>
                    
                    // Send shipping notification<br>
                    function sendShippingNotification($orderId, $trackingNumber) {<br>
                    &nbsp;&nbsp;$to = $order['email'];<br>
                    &nbsp;&nbsp;$subject = "Your Order Has Been Shipped";<br>
                    &nbsp;&nbsp;$message = "Your order #$orderId has been shipped.\n";<br>
                    &nbsp;&nbsp;$message .= "Tracking Number: $trackingNumber";<br><br>
                    
                    &nbsp;&nbsp;mail($to, $subject, $message);<br>
                    }
                </div>
            </section>

            <!-- Slide 19: Admin Panel -->
            <section>
                <h2>Admin Panel</h2>
                <div class="code-example">
                    Admin Functions:<br><br>
                    
                    // Get all orders for admin<br>
                    function getAllOrders() {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->query("SELECT o.*, u.username FROM orders o JOIN users u ON o.user_id = u.id ORDER BY o.created_at DESC");<br>
                    &nbsp;&nbsp;return $stmt->fetchAll();<br>
                    }<br><br>
                    
                    // Update product stock<br>
                    function updateProductStock($productId, $newStock) {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->prepare("UPDATE products SET stock = ? WHERE id = ?");<br>
                    &nbsp;&nbsp;$stmt->execute([$newStock, $productId]);<br>
                    }<br><br>
                    
                    // Get sales statistics<br>
                    function getSalesStats() {<br>
                    &nbsp;&nbsp;global $pdo;<br>
                    &nbsp;&nbsp;$stmt = $pdo->query("SELECT COUNT(*) as total_orders, SUM(total) as total_revenue FROM orders WHERE status = 'completed'");<br>
                    &nbsp;&nbsp;return $stmt->fetch();<br>
                    }<br><br>
                    
                    // Check admin access<br>
                    if (!hasRole('admin')) {<br>
                    &nbsp;&nbsp;header("Location: access-denied.php");<br>
                    &nbsp;&nbsp;exit();<br>
                    }
                </div>
            </section>

            <!-- Slide 20: Payment Integration -->
            <section>
                <h2>Payment Integration</h2>
                <div class="code-example">
                    Payment Processing:<br><br>
                    
                    // Mock payment processing<br>
                    function processPayment($amount, $cardNumber, $expiryDate, $cvv) {<br>
                    &nbsp;&nbsp;// In real implementation, integrate with payment gateway<br>
                    &nbsp;&nbsp;$paymentId = 'PAY' . time() . rand(1000, 9999);<br><br>
                    
                    &nbsp;&nbsp;// Simulate payment processing<br>
                    &nbsp;&nbsp;if (strlen($cardNumber) == 16 && strlen($cvv) == 3) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;return [<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'success' => true,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'payment_id' => $paymentId,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'amount' => $amount<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;];<br>
                    &nbsp;&nbsp;} else {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;return [<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'success' => false,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'error' => 'Invalid payment details'<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;];<br>
                    &nbsp;&nbsp;}<br>
                    }<br><br>
                    
                    // Process payment in checkout<br>
                    $paymentResult = processPayment($finalTotal, $_POST['card_number'], $_POST['expiry'], $_POST['cvv']);<br>
                    if ($paymentResult['success']) {<br>
                    &nbsp;&nbsp;// Continue with order creation<br>
                    } else {<br>
                    &nbsp;&nbsp;echo "Payment failed: " . $paymentResult['error'];<br>
                    }
                </div>
            </section>

            <!-- Slide 21: TASK 2 - Final Task -->
            <section class="center">
                <h2>Task 2: Complete E-commerce Platform</h2>
                <div class="task-box">
                    <h3>Instructions:</h3>
                    <ol>
                        <li>Build a complete e-commerce platform with:</li>
                        <ul>
                            <li>Product reviews and ratings system</li>
                            <li>Wishlist functionality</li>
                            <li>Discount and coupon system</li>
                            <li>Shipping calculator</li>
                            <li>Order tracking system</li>
                            <li>Email notifications</li>
                            <li>Admin panel for management</li>
                            <li>Payment processing integration</li>
                        </ul>
                        <li>Implement advanced features</li>
                        <li>Add comprehensive error handling</li>
                        <li>Create responsive design</li>
                        <li>Test all e-commerce functionality</li>
                    </ol>
                    <p><strong>Time:</strong> 45 minutes</p>
                    <p><em>This task will help you build a professional e-commerce platform</em></p>
                </div>
            </section>

            <!-- Slide 22: Summary -->
            <section class="center">
                <h2>Session Summary</h2>
                <ul>
                    <li>Product catalogues organize and display products effectively</li>
                    <li>Shopping carts manage user selections</li>
                    <li>Checkout processes handle order completion</li>
                    <li>Order management tracks order status</li>
                    <li>Inventory management prevents overselling</li>
                    <li>Search functionality helps users find products</li>
                    <li>Reviews and ratings build trust</li>
                    <li>Admin panels manage e-commerce operations</li>
                </ul>
                <div class="highlight">
                    <h3>Next Session:</h3>
                    <p>Advanced PHP Features & Security - Object-oriented PHP, input validation, and security hardening</p>
                </div>
            </section>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            transition: 'slide',
            transitionSpeed: 'default',
            backgroundTransition: 'fade',
            controls: true,
            progress: true,
            center: false,
            touch: true,
            loop: false,
            rtl: false,
            navigationMode: 'default',
            shuffle: false,
            fragments: true,
            fragmentInURL: false,
            embedded: false,
            help: true,
            showNotes: false,
            autoPlayMedia: null,
            preloadIframes: null,
            autoSlide: 0,
            autoSlideStoppable: true,
            autoSlideMethod: Reveal.navigateNext,
            defaultTiming: null,
            mouseWheel: false,
            hideInactiveCursor: true,
            hideCursorTime: 5000,
            previewLinks: false,
            postMessage: true,
            postMessageEvents: false,
            focusBodyOnPageVisibilityChange: true,
            viewDistance: 3,
            mobileViewDistance: 2,
            display: 'block',
            hideEmptyElements: true,
            width: '100%',
            height: '100%',
            margin: 0.04,
            minScale: 0.2,
            maxScale: 2.0,
            fitToParent: true,
            responsive: true,
            scrollBeyondOnePage: true
        });
    </script>
</body>
</html>
