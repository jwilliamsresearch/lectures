<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMU529 - Session 10: Advanced PHP Features & Security</title>
    <link rel="stylesheet" href="../../libs/reveal.js/dist/reset.css">
    <link rel="stylesheet" href="../../libs/reveal.js/dist/reveal.css">
    <link rel="stylesheet" href="../../placeholder/academic-theme.css">
    
    <!-- Syntax highlighting -->
    <link rel="stylesheet" href="../../libs/reveal.js/plugin/highlight/monokai.css">
    <style>
        .reveal .slides section {
            text-align: left;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
            max-height: 100vh;
        }
        .reveal .slides section h1 { font-size: 2.5em; margin-bottom: 0.5em; }
        .reveal .slides section h2 { font-size: 2em; margin-bottom: 0.5em; }
        .reveal .slides section h3 { font-size: 1.5em; margin-bottom: 0.5em; }
        .reveal .slides section p { font-size: 1.1em; line-height: 1.4; margin-bottom: 0.8em; }
        .reveal .slides section ul, .reveal .slides section ol { font-size: 1em; line-height: 1.4; margin-bottom: 0.8em; }
        .reveal .slides section li { margin-bottom: 0.3em; }
        .task-box {
            background: #fff5f5;
            border: 2px solid #ff6b6b;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            max-height: 60vh;
            overflow-y: auto;
        }
        .code-example {
            margin: 10px 0;
            max-width: 100%;
            overflow: visible;
        }

        .code-example pre {
            margin: 0;
        }
        .highlight {
            background: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
            margin: 10px 0;
        }
        .timeline-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-size: 0.9em;
        }
        .timeline-info ul { margin: 10px 0; padding-left: 20px; }
        .timeline-info li { margin-bottom: 0.2em; }
        .diagram {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        @media (max-width: 768px) {
            .reveal .slides section { padding: 15px; }
            .reveal .slides section h1 { font-size: 2em; }
            .reveal .slides section h2 { font-size: 1.6em; }
            .reveal .slides section h3 { font-size: 1.3em; }
            .task-box, .code-example { font-size: 0.9em; padding: 15px; }
        }
        
        /* Custom scrollbar styling */
        .reveal .slides section::-webkit-scrollbar,
        .task-box::-webkit-scrollbar,
        .reveal .slides section::-webkit-scrollbar-track,
        .task-box::-webkit-scrollbar-track,
        .reveal .slides section::-webkit-scrollbar-thumb,
        .task-box::-webkit-scrollbar-thumb,
        .reveal .slides section::-webkit-scrollbar-thumb:hover,
        .task-box::-webkit-scrollbar-thumb:hover,
        </style>
</head>
<body>
            <div class="slide-nav">
        <a href="../../index.html" title="Home">H</a>
        <a href="../index.html" title="Module Home">M</a>
        <a href="session9.html" title="Previous Session">&lt;</a>
        <a href="session11.html" title="Next Session">&gt;</a>
    </div>
    <div class="reveal">
        <div class="slides">
            <!-- Slide 1: Title -->
            <section class="title-slide">
                <div class="module-code">CMU529: Advanced Web Development - Session 10</div>
                <h1>Session 10</h1>
                <h2>Full-stack Web Development with PHP and MySQL</h2>
                <div class="author">
                    <p><strong>James Williams</strong></p>
                    <p>Birmingham Newman University</p>
                    <p class="text-muted">jwilliams@staff.newman.ac.uk</p>
                    <p class="text-muted">3-hour session</p>
                </div>
            </section>

            

            <!-- Slide 2: Session Timeline -->
            <section data-slide-title="Session Timeline"><h2>Session Timeline</h2>
                
            </section>

            <!-- Slide 3: Advanced PHP Features Overview -->
            <section data-slide-title="Advanced PHP Features Overview"><h2>Advanced PHP Features Overview</h2>
                <div class="highlight">
                    <h4>Key Areas:</h4>
                    <ul>
                        <li>Object-Oriented Programming (OOP)</li>
                        <li>Namespaces & Autoloading</li>
                        <li>Advanced Error Handling</li>
                        <li>Security Best Practices</li>
                        <li>Performance Optimization</li>
                    </ul>
                </div>
            </section>

            <!-- Slide 4: Object-Oriented Programming -->
            <section data-slide-title="Object-Oriented Programming"><h2>Object-Oriented Programming</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  class User {
    private $id;
    private $username;
    private $email;
    public function __construct($username, $email) {
      $this-&gt;username = $username;
      $this-&gt;email = $email;
    }
    public function getUsername() {
      return $this-&gt;username;
    }
  }
  $user = new User("john_doe", "john@example.com");
  echo $user-&gt;getUsername(); // Output: john_doe
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 5: Namespaces -->
            <section data-slide-title="Namespaces"><h2>Namespaces</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  namespace App\Models;
  class Product {
    private $name;
    private $price;
    public function __construct($name, $price) {
      $this-&gt;name = $name;
      $this-&gt;price = $price;
    }
  }
  // Using the class
  use App\Models\Product;
  $product = new Product("Laptop", 999.99);
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 6: Advanced Error Handling -->
            <section data-slide-title="Advanced Error Handling"><h2>Advanced Error Handling</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  set_error_handler(function($severity, $message, $file, $line) {
    throw new ErrorException($message, 0, $severity, $file, $line);
  });
  try {
    $result = 10 / 0;
  } catch (ErrorException $e) {
    error_log("Error: " . $e-&gt;getMessage());
    echo "An error occurred. Please try again.";
  } finally {
    restore_error_handler();
  }
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 7: Security Best Practices -->
            <section data-slide-title="Security Best Practices"><h2>Security Best Practices</h2>
                <div class="highlight">
                    <h4>Essential Security Measures:</h4>
                    <ul>
                        <li>Input Validation & Sanitization</li>
                        <li>SQL Injection Prevention</li>
                        <li>XSS Protection</li>
                        <li>CSRF Protection</li>
                        <li>Password Hashing</li>
                    </ul>
                </div>
            </section>

            <!-- Slide 8: Input Validation & Sanitization -->
            <section data-slide-title="Input Validation & Sanitization"><h2>Input Validation & Sanitization</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  function validateEmail($email) {
    return filter_var($email, FILTER_VALIDATE_EMAIL);
  }
  function sanitizeInput($input) {
    $input = trim($input);
    $input = stripslashes($input);
    $input = htmlspecialchars($input, ENT_QUOTES, 'UTF-8');
    return $input;
  }
  $email = sanitizeInput($_POST['email']);
  if (validateEmail($email)) {
    // Process valid email
  }
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 9: SQL Injection Prevention -->
            <section data-slide-title="SQL Injection Prevention"><h2>SQL Injection Prevention</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  // BAD - Vulnerable to SQL injection
  $username = $_POST['username'];
  $query = "SELECT * FROM users WHERE username = '$username'";
  // GOOD - Using prepared statements
  $stmt = $pdo-&gt;prepare("SELECT * FROM users WHERE username = ?");
  $stmt-&gt;execute([$username]);
  $user = $stmt-&gt;fetch();
  // Also good - Using named parameters
  $stmt = $pdo-&gt;prepare("SELECT * FROM users WHERE username = :username");
  $stmt-&gt;execute(['username' =&gt; $username]);
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 10: XSS Protection -->
            <section data-slide-title="XSS Protection"><h2>XSS Protection</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  // Prevent XSS attacks
  function escapeOutput($data) {
    if (is_array($data)) {
      return array_map('escapeOutput', $data);
    }
    return htmlspecialchars($data, ENT_QUOTES, 'UTF-8');
  }
  $userInput = "&lt;script&gt;alert('XSS')&lt;/script&gt;";
  echo escapeOutput($userInput);
  // Output: &amp;lt;script&amp;gt;alert('XSS')&amp;lt;/script&amp;gt;
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 11: CSRF Protection -->
            <section data-slide-title="CSRF Protection"><h2>CSRF Protection</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  session_start();
  // Generate CSRF token
  if (!isset($_SESSION['csrf_token'])) {
    $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
  }
  // In form
  echo '&lt;input type="hidden" name="csrf_token" value="' . $_SESSION['csrf_token'] . '"&gt;';
  // Verify token
  if ($_POST['csrf_token'] !== $_SESSION['csrf_token']) {
    die('CSRF token validation failed');
  }
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 12: Password Security -->
            <section data-slide-title="Password Security"><h2>Password Security</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  // Hash password
  $password = "user_password";
  $hashedPassword = password_hash($password, PASSWORD_DEFAULT);
  // Verify password
  if (password_verify($password, $hashedPassword)) {
    echo "Password is correct";
  }
  // Check if password needs rehashing
  if (password_needs_rehash($hashedPassword, PASSWORD_DEFAULT)) {
    $newHash = password_hash($password, PASSWORD_DEFAULT);
  }
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 13: Performance Optimization -->
            <section data-slide-title="Performance Optimization"><h2>Performance Optimization</h2>
                <div class="highlight">
                    <h4>Optimization Techniques:</h4>
                    <ul>
                        <li>Database Query Optimization</li>
                        <li>Caching Strategies</li>
                        <li>Code Optimization</li>
                        <li>Memory Management</li>
                    </ul>
                </div>
            </section>

            <!-- Slide 14: Database Query Optimization -->
            <section data-slide-title="Database Query Optimization"><h2>Database Query Optimization</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  // BAD - N+1 query problem
  $users = $pdo-&gt;query("SELECT * FROM users")-&gt;fetchAll();
  foreach ($users as $user) {
    $orders = $pdo-&gt;query("SELECT * FROM orders WHERE user_id = " . $user['id']);
  }
  // GOOD - Single query with JOIN
  $stmt = $pdo-&gt;query("SELECT u.*, o.* FROM users u LEFT JOIN orders o ON u.id = o.user_id");
  $results = $stmt-&gt;fetchAll();
  // Use indexes
  // CREATE INDEX idx_user_email ON users(email);
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 15: Caching Strategies -->
            <section data-slide-title="Caching Strategies"><h2>Caching Strategies</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  // Simple file caching
  function getCachedData($key, $callback, $ttl = 3600) {
    $cacheFile = "cache/" . md5($key) . ".cache";
    if (file_exists($cacheFile) &amp;&amp; (time() - filemtime($cacheFile)) &lt; $ttl) {
      return unserialize(file_get_contents($cacheFile));
    }
    $data = $callback();
    file_put_contents($cacheFile, serialize($data));
    return $data;
  }
  $products = getCachedData('products', function() use ($pdo) {
    return $pdo-&gt;query("SELECT * FROM products")-&gt;fetchAll();
  });
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 16: Code Optimization -->
            <section data-slide-title="Code Optimization"><h2>Code Optimization</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  // BAD - Inefficient loops
  for ($i = 0; $i &lt; count($array); $i++) {
    echo $array[$i];
  }
  // GOOD - Optimized loops
  $count = count($array);
  for ($i = 0; $i &lt; $count; $i++) {
    echo $array[$i];
  }
  // Even better - foreach
  foreach ($array as $item) {
    echo $item;
  }
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 17: Memory Management -->
            <section data-slide-title="Memory Management"><h2>Memory Management</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  // Set memory limit
  ini_set('memory_limit', '256M');
  // Process large datasets in chunks
  $offset = 0;
  $limit = 1000;
  do {
    $stmt = $pdo-&gt;prepare("SELECT * FROM large_table LIMIT ? OFFSET ?");
    $stmt-&gt;execute([$limit, $offset]);
    $rows = $stmt-&gt;fetchAll();
    foreach ($rows as $row) {
      // Process row
    }
    $offset += $limit;
  } while (count($rows) == $limit);
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 18: Task 1 -->
            <section data-slide-title="Task 1: Security Implementation"><h2>Task 1: Security Implementation</h2>
                <div class="task-box">
                    <h4>Create a secure user registration system:</h4>
                    <ul>
                        <li>Implement input validation for username, email, and password</li>
                        <li>Add CSRF protection to the registration form</li>
                        <li>Hash passwords using password_hash()</li>
                        <li>Prevent SQL injection using prepared statements</li>
                        <li>Add XSS protection for output</li>
                        <li>Implement proper error handling</li>
                    </ul>
                    <p><strong>Time:</strong> 45 minutes</p>
                </div>
            </section>

            <!-- Slide 19: Advanced Features -->
            <section data-slide-title="Advanced Features"><h2>Advanced Features</h2>
                <div class="highlight">
                    <h4>Additional Advanced Topics:</h4>
                    <ul>
                        <li>File Upload Security</li>
                        <li>Session Security</li>
                        <li>API Security</li>
                        <li>Logging & Monitoring</li>
                    </ul>
                </div>
            </section>

            <!-- Slide 20: File Upload Security -->
            <section data-slide-title="File Upload Security"><h2>File Upload Security</h2>
                <div class="code-example">
                <pre><code class="language-php">&lt;?php
  function validateFileUpload($file) {
    $allowedTypes = ['image/jpeg', 'image/png', 'image/gif'];
    $maxSize = 5 * 1024 * 1024; // 5MB
    if ($file['error'] !== UPLOAD_ERR_OK) {
      return false;
    }
    if (!in_array($file['type'], $allowedTypes)) {
      return false;
    }
    if ($file['size'] &gt; $maxSize) {
      return false;
    }
    return true;
  }
?&gt;</code></pre>
            </div>
            </section>

            <!-- Slide 21: Task 2 -->
            <section data-slide-title="Task 2: Performance Optimization"><h2>Task 2: Performance Optimization</h2>
                <div class="task-box">
                    <h4>Optimize an existing e-commerce application:</h4>
                    <ul>
                        <li>Implement database query optimization</li>
                        <li>Add caching for product listings</li>
                        <li>Optimize image loading and storage</li>
                        <li>Implement pagination for large datasets</li>
                        <li>Add error logging and monitoring</li>
                        <li>Optimize memory usage</li>
                    </ul>
                    <p><strong>Time:</strong> 45 minutes</p>
                </div>
            </section>

            <!-- Slide 22: Summary -->
            <section data-slide-title="Session Summary"><h2>Session Summary</h2>
                <div class="highlight">
                    <h4>Key Takeaways:</h4>
                    <ul>
                        <li>Advanced PHP features enhance code organization and reusability</li>
                        <li>Security is critical - always validate, sanitize, and protect</li>
                        <li>Performance optimization improves user experience</li>
                        <li>Proper error handling and logging are essential</li>
                        <li>Follow best practices for production applications</li>
                    </ul>
                </div>
                <p><strong>Next Session:</strong> Modern JavaScript Libraries</p>
            </section>
        </div>
    </div>

    <script src="../../libs/reveal.js/dist/reveal.js"></script>
    <script src="../../libs/reveal.js/plugin/notes/notes.js"></script>
    <script src="../../libs/reveal.js/plugin/markdown/markdown.js"></script>
    <script src="../../libs/reveal.js/plugin/highlight/highlight.js"></script>
    <script>
        
        // Prevent wheel events from changing slides when scrolling within scrollable content
        document.addEventListener('DOMContentLoaded', function() {
            const scrollableElements = document.querySelectorAll('.reveal pre, .reveal .code-example, .reveal .task-box, .reveal .info-box, .reveal .warning-box, [style*="overflow"]');
            
            scrollableElements.forEach(function(element) {
                element.addEventListener('wheel', function(e) {
                    e.stopPropagation();
                }, { passive: true });
            });
        });
        Reveal.initialize({
            hash: true,
            slideNumber: true,
            transition: 'none',
            backgroundTransition: 'none',
            center: false,
            disableLayout: true,
            plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
        });
    </script>
</body>
</html>
