<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMM721 - Session 5: Asynchronous JavaScript & APIs</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/reset.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/reveal.css">
    <link rel="stylesheet" href="../../placeholder/academic-theme.css">

    <!-- Syntax highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/plugin/highlight/monokai.css">
</head>

<body>
    <div class="slide-nav">
        <a href="../../index.html" title="Home">H</a>
        <a href="../index.html" title="Module Home">M</a>
        <a href="session4.html" title="Previous Session">&lt;</a>
        <a href="session6.html" title="Next Session">&gt;</a>
    </div>
    <div class="reveal">
        <div class="slides">

            <!-- Title Slide -->
            <section class="title-slide" data-slide-title="Title Slide">
                <div class="module-code">CMM721</div>
                <h1>Asynchronous JavaScript & APIs</h1>
                <h2>Session 5</h2>
                <div class="author">
                    <p><strong>James Williams</strong></p>
                    <p><a href="mailto:jwilliams@staff.newman.ac.uk">jwilliams@staff.newman.ac.uk</a></p>
                </div>
            </section>

            <section data-slide-title="Learning Objectives">
                <h2>Learning Objectives</h2>
                <ul>
                    <li>Understand asynchronous programming concepts</li>
                    <li>Master Promises and async/await syntax</li>
                    <li>Use the Fetch API for HTTP requests</li>
                    <li>Integrate with REST APIs</li>
                    <li>Handle errors in asynchronous code</li>
                </ul>
            </section>

            <section data-slide-title="Synchronous vs Asynchronous">
                <h2>Synchronous vs Asynchronous</h2>
                <div class="highlight">
                    <strong>Synchronous:</strong> Code executes line by line, blocking
                </div>
                <div class="code-example">
                    <pre><code class="language-javascript">console.log('First');
console.log('Second');
console.log('Third');
// Output: First, Second, Third</code></pre>
                </div>
                <div class="highlight">
                    <strong>Asynchronous:</strong> Non-blocking, allows other code to run
                </div>
                <div class="code-example">
                    <pre><code class="language-javascript">console.log('First');
setTimeout(() =&gt; console.log('Second'), 1000);
console.log('Third');
// Output: First, Third, Second (after 1s)</code></pre>
                </div>
            </section>

            <section data-slide-title="Callbacks">
                <h2>Callbacks</h2>
                <h3>Traditional Async Pattern:</h3>
                <div class="code-example">
                    <pre><code class="language-javascript">function fetchData(callback) {
setTimeout(() =&gt; {
const data = {name: 'John', age: 30};
callback(data);
}, 1000);
}
fetchData((result) =&gt; {
console.log(result);
});</code></pre>
                </div>
                <h3>Problem: Callback Hell</h3>
                <div class="code-example">
                    <pre><code class="language-javascript">getData(function(a) {
getMoreData(a, function(b) {
getMoreData(b, function(c) {
// Nested callbacks...
});
});
});</code></pre>
                </div>
            </section>

            <section data-slide-title="Promises">
                <h2>Promises</h2>
                <div class="highlight">
                    <strong>Promise:</strong> Object representing eventual completion/failure
                </div>
                <div class="code-example">
                    <pre><code class="language-javascript">const promise = new Promise((resolve, reject) =&gt; {
setTimeout(() =&gt; {
const success = true;
if (success) {
resolve({data: 'Success!'});
} else {
reject(new Error('Failed'));
}
}, 1000);
});
promise
.then(result =&gt; console.log(result))
.catch(error =&gt; console.error(error));</code></pre>
                </div>
            </section>

            <section data-slide-title="üéØ LIVE DEMO: Promise Simulator">
                <h2>üéØ LIVE DEMO: Promise Simulator</h2>
                <div class="demo-container">
                    <h3>Interactive Promise Example</h3>
                    <button class="demo-button" onclick="runSuccessPromise()">Run Success Promise</button>
                    <button class="demo-button" onclick="runFailPromise()">Run Fail Promise</button>
                    <button class="demo-button" onclick="runChainedPromises()">Chain Promises</button>
                    <div id="promiseOutput" class="demo-output">
                        Click a button to see Promises in action!
                    </div>
                </div>
                
                <script>
                    function runSuccessPromise() {
                        const output = document.getElementById('promiseOutput');
                        output.innerHTML = '<span class="loading">‚è≥ Promise pending...</span>';
                        
                        new Promise((resolve) => {
                            setTimeout(() => resolve('‚úÖ Promise resolved successfully!'), 2000);
                        })
                        .then(result => {
                            output.innerHTML = `<span class="success">${result}</span><br>
                                              <small>Resolved after 2 seconds</small>`;
                        });
                    }
                    
                    function runFailPromise() {
                        const output = document.getElementById('promiseOutput');
                        output.innerHTML = '<span class="loading">‚è≥ Promise pending...</span>';
                        
                        new Promise((resolve, reject) => {
                            setTimeout(() => reject(new Error('Network error')), 2000);
                        })
                        .catch(error => {
                            output.innerHTML = `<span class="error">‚ùå Promise rejected: ${error.message}</span><br>
                                              <small>Caught and handled the error</small>`;
                        });
                    }
                    
                    function runChainedPromises() {
                        const output = document.getElementById('promiseOutput');
                        output.innerHTML = '<span class="loading">‚è≥ Step 1...</span>';
                        
                        Promise.resolve('Step 1')
                            .then(result => {
                                output.innerHTML = `<span class="success">‚úÖ ${result} complete</span><br><span class="loading">‚è≥ Step 2...</span>`;
                                return new Promise(resolve => setTimeout(() => resolve('Step 2'), 1000));
                            })
                            .then(result => {
                                output.innerHTML += `<br><span class="success">‚úÖ ${result} complete</span><br><span class="loading">‚è≥ Step 3...</span>`;
                                return new Promise(resolve => setTimeout(() => resolve('Step 3'), 1000));
                            })
                            .then(result => {
                                output.innerHTML += `<br><span class="success">‚úÖ ${result} complete</span><br><strong>All steps finished!</strong>`;
                            });
                    }
                </script>
            </section>

            <section data-slide-title="Async/Await">
                <h2>Async/Await</h2>
                <div class="highlight">
                    <strong>async/await:</strong> Syntactic sugar for Promises (ES2017)
                </div>
                <div class="code-example">
                    <pre><code class="language-javascript">// Promise approach
fetch('https://api.example.com/data')
.then(response =&gt; response.json())
.then(data =&gt; console.log(data))
.catch(error =&gt; console.error(error));
// async/await approach
async function fetchData() {
try {
const response = await fetch('https://api.example.com/data');
const data = await response.json();
console.log(data);
} catch (error) {
console.error(error);
}
}</code></pre>
                </div>
            </section>

            <section data-slide-title="Fetch API">
                <h2>Fetch API</h2>
                <h3>Making HTTP Requests:</h3>
                <div class="code-example">
                    <pre><code class="language-javascript">// GET request
fetch('https://api.github.com/users/github')
.then(response =&gt; response.json())
.then(data =&gt; console.log(data));
// POST request
fetch('https://api.example.com/users', {
method: 'POST',
headers: {
'Content-Type': 'application/json'
},
body: JSON.stringify({name: 'John', age: 30})
})
.then(response =&gt; response.json())
.then(data =&gt; console.log(data));</code></pre>
                </div>
            </section>

            <section data-slide-title="üéØ LIVE DEMO: Real API Integration">
                <h2>üéØ LIVE DEMO: Real API Integration</h2>
                <div class="demo-container">
                    <h3>Fetch GitHub User Data</h3>
                    <input type="text" id="githubUsername" placeholder="Enter GitHub username" 
                           style="padding: 10px; font-size: 1em; width: 60%; border: 2px solid #9b59b6; border-radius: 5px;">
                    <button class="demo-button" onclick="fetchGitHubUser()">Fetch User</button>
                    <button class="demo-button" onclick="fetchRandomUser()">Random User API</button>
                    <div id="apiOutput" class="demo-output">
                        Try: "github", "torvalds", or click Random User
                    </div>
                </div>
                
                <script>
                    async function fetchGitHubUser() {
                        const username = document.getElementById('githubUsername').value || 'github';
                        const output = document.getElementById('apiOutput');
                        output.innerHTML = '<span class="loading">‚è≥ Fetching data from GitHub API...</span>';
                        
                        try {
                            const response = await fetch(`https://api.github.com/users/${username}`);
                            if (!response.ok) throw new Error('User not found');
                            const data = await response.json();
                            
                            output.innerHTML = `
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <img src="${data.avatar_url}" width="80" style="border-radius: 50%;">
                                    <div>
                                        <h4 style="margin: 0;">${data.name || data.login}</h4>
                                        <p style="margin: 5px 0;"><strong>@${data.login}</strong></p>
                                        <p style="margin: 5px 0;">${data.bio || 'No bio'}</p>
                                        <p style="margin: 5px 0;">üìç ${data.location || 'Unknown'}</p>
                                        <p style="margin: 5px 0;">üë• ${data.followers} followers ‚Ä¢ ${data.public_repos} repos</p>
                                    </div>
                                </div>
                            `;
                        } catch (error) {
                            output.innerHTML = `<span class="error">‚ùå Error: ${error.message}</span>`;
                        }
                    }
                    
                    async function fetchRandomUser() {
                        const output = document.getElementById('apiOutput');
                        output.innerHTML = '<span class="loading">‚è≥ Fetching random user...</span>';
                        
                        try {
                            const response = await fetch('https://randomuser.me/api/');
                            const data = await response.json();
                            const user = data.results[0];
                            
                            output.innerHTML = `
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <img src="${user.picture.large}" width="80" style="border-radius: 50%;">
                                    <div>
                                        <h4 style="margin: 0;">${user.name.first} ${user.name.last}</h4>
                                        <p style="margin: 5px 0;">üìß ${user.email}</p>
                                        <p style="margin: 5px 0;">üì± ${user.phone}</p>
                                        <p style="margin: 5px 0;">üìç ${user.location.city}, ${user.location.country}</p>
                                    </div>
                                </div>
                                <small>Data from randomuser.me API</small>
                            `;
                        } catch (error) {
                            output.innerHTML = `<span class="error">‚ùå Error: ${error.message}</span>`;
                        }
                    }
                </script>
            </section>

            <section data-slide-title="Task 1: Weather App with API">
                <h2>Task 1: Weather App with API</h2>
                <div class="task-box">
                    <h3>Objective:</h3>
                    <p>Build a weather application using the OpenWeather API</p>
                    <h3>Requirements:</h3>
                    <ol>
                        <li>Create UI with city input and search button</li>
                        <li>Fetch weather data using async/await</li>
                        <li>Display: temperature, weather description, icon</li>
                        <li>Show loading state during fetch</li>
                        <li>Handle errors (invalid city, network issues)</li>
                        <li>Add 5-day forecast display</li>
                    </ol>
                    <h3>API:</h3>
                    <ul>
                        <li>OpenWeatherMap API (free tier)</li>
                        <li>Register at openweathermap.org</li>
                    </ul>
                </div>
            </section>

            <section data-slide-title="Error Handling in Async Code">
                <h2>Error Handling in Async Code</h2>
                <div class="code-example">
                    <pre><code class="language-javascript">async function fetchUserData(userId) {
try {
const response = await fetch(`/api/users/${userId}`);
if (!response.ok) {
throw new Error(`HTTP error! status: ${response.status}`);
}
const data = await response.json();
return data;
} catch (error) {
console.error('Failed to fetch user:', error);
throw error; // Re-throw if needed
} finally {
console.log('Fetch attempt completed');
}
}</code></pre>
                </div>
            </section>

            <section data-slide-title="üéØ LIVE DEMO: Programming Jokes & Facts">
                <h2>üéØ LIVE DEMO: Programming Jokes & Facts</h2>
                <div class="demo-container">
                    <h3>Programming Humor & Knowledge</h3>
                    <button class="demo-button" onclick="fetchProgrammingJoke()">Get Programming Joke</button>
                    <button class="demo-button" onclick="fetchProgrammingFact()">Get Programming Fact</button>
                    <div id="jokeOutput" class="demo-output" style="font-size: 1.1em; line-height: 1.6;">
                        Click a button to fetch programming content!
                    </div>
                </div>
                
                <script>
                    async function fetchProgrammingJoke() {
                        const output = document.getElementById('jokeOutput');
                        output.innerHTML = '<span class="loading">‚è≥ Fetching programming joke...</span>';
                        
                        try {
                            const response = await fetch('https://v2.jokeapi.dev/joke/Programming?blacklistFlags=nsfw,religious,political,racist,sexist,explicit&type=single');
                            const data = await response.json();
                            
                            if (data.joke) {
                                output.innerHTML = `<p>üòÑ <strong>${data.joke}</strong></p>
                                                  <small>Category: ${data.category}</small>`;
                            } else if (data.setup && data.delivery) {
                                output.innerHTML = `<p>üòÑ <strong>${data.setup}</strong></p>
                                                  <p style="margin-top: 10px;">...${data.delivery}</p>
                                                  <small>Category: ${data.category}</small>`;
                            }
                        } catch (error) {
                            output.innerHTML = `<span class="error">‚ùå Failed to fetch joke</span>`;
                        }
                    }
                    
                    async function fetchProgrammingFact() {
                        const output = document.getElementById('jokeOutput');
                        
                        // Array of interesting programming facts
                        const programmingFacts = [
                            "The first computer bug was an actual bug - a moth found in the Harvard Mark II computer in 1947.",
                            "Python was named after Monty Python's Flying Circus, not the snake.",
                            "The first computer programmer was Ada Lovelace in the 1840s, writing algorithms for Charles Babbage's Analytical Engine.",
                            "JavaScript was created in just 10 days by Brendan Eich in 1995.",
                            "The first computer virus was created in 1983 and was called 'Elk Cloner'.",
                            "Git was created by Linus Torvalds in 2005, the same person who created Linux.",
                            "The '@' symbol in email addresses was chosen by Ray Tomlinson in 1971.",
                            "The term 'debugging' originated from Admiral Grace Hopper removing an actual moth from a computer.",
                            "Python's philosophy is summarized in 'The Zen of Python' - try typing 'import this' in Python!",
                            "React was created by Jordan Walke at Facebook and released in 2013.",
                            "The first website ever created is still online at info.cern.ch.",
                            "C programming language was developed at Bell Labs by Dennis Ritchie between 1972-1973.",
                            "Stack Overflow was launched in 2008 and now has over 20 million questions.",
                            "The term 'cookie' in web development comes from 'magic cookie', a Unix programming term.",
                            "Django framework was named after the jazz guitarist Django Reinhardt."
                        ];
                        
                        const randomFact = programmingFacts[Math.floor(Math.random() * programmingFacts.length)];
                        output.innerHTML = `<p>üí° <strong>${randomFact}</strong></p>
                                          <small>Programming history & trivia</small>`;
                    }
                </script>
            </section>

            <section data-slide-title="REST API Concepts">
                <h2>REST API Concepts</h2>
                <div class="highlight">
                    <strong>REST:</strong> Representational State Transfer
                </div>
                <h3>HTTP Methods (CRUD):</h3>
                <ul>
                    <li><strong>GET:</strong> Read/retrieve data</li>
                    <li><strong>POST:</strong> Create new data</li>
                    <li><strong>PUT:</strong> Update/replace data</li>
                    <li><strong>PATCH:</strong> Partial update</li>
                    <li><strong>DELETE:</strong> Remove data</li>
                </ul>
                <h3>Response Status Codes:</h3>
                <ul>
                    <li><strong>200:</strong> OK</li>
                    <li><strong>201:</strong> Created</li>
                    <li><strong>400:</strong> Bad Request</li>
                    <li><strong>401:</strong> Unauthorized</li>
                    <li><strong>404:</strong> Not Found</li>
                    <li><strong>500:</strong> Internal Server Error</li>
                </ul>
            </section>

            <section data-slide-title="Task 2: Todo API Integration">
                <h2>Task 2: Todo API Integration</h2>
                <div class="task-box">
                    <h3>Objective:</h3>
                    <p>Create a todo app using JSONPlaceholder API</p>
                    <h3>Requirements:</h3>
                    <ol>
                        <li>Fetch todos from: jsonplaceholder.typicode.com/todos</li>
                        <li>Display todos with checkboxes</li>
                        <li>Implement POST to create new todo (simulated)</li>
                        <li>Implement DELETE to remove todo (simulated)</li>
                        <li>Show loading states for all operations</li>
                        <li>Handle all errors gracefully</li>
                        <li>Add filter: all/completed/active</li>
                    </ol>
                    <h3>Bonus:</h3>
                    <ul>
                        <li>Add pagination (10 items per page)</li>
                        <li>Implement search functionality</li>
                    </ul>
                </div>
            </section>

            <section data-slide-title="Parallel Requests">
                <h2>Parallel Requests</h2>
                <h3>Promise.all - Wait for all:</h3>
                <div class="code-example">
                    <pre><code class="language-javascript">async function fetchMultiple() {
try {
const [users, posts, comments] = await Promise.all([
fetch('/api/users').then(r =&gt; r.json()),
fetch('/api/posts').then(r =&gt; r.json()),
fetch('/api/comments').then(r =&gt; r.json())
]);
return {users, posts, comments};
} catch (error) {
console.error('One of the requests failed:', error);
}
}</code></pre>
                </div>
                <h3>Promise.race - First to finish:</h3>
                <div class="code-example">
                    <pre><code class="language-javascript">const fastest = await Promise.race([
fetch('https://api1.example.com'),
fetch('https://api2.example.com')
]);</code></pre>
                </div>
            </section>

            <section data-slide-title="Best Practices">
                <h2>Best Practices</h2>
                <ul>
                    <li><strong>Always handle errors:</strong> Use try/catch with async/await</li>
                    <li><strong>Loading states:</strong> Show feedback during async operations</li>
                    <li><strong>Timeout handling:</strong> Implement request timeouts</li>
                    <li><strong>Avoid callback hell:</strong> Use Promises or async/await</li>
                    <li><strong>Cancel requests:</strong> Use AbortController for cleanup</li>
                    <li><strong>Cache responses:</strong> Avoid redundant API calls</li>
                </ul>
                <div class="highlight">
                    <strong>Remember:</strong> async functions always return a Promise
                </div>
            </section>

            <section data-slide-title="Next Session: Django Basics">
                <h2>Next Session: Django Basics</h2>
                <ul>
                    <li>Introduction to Django framework</li>
                    <li>Project and app structure</li>
                    <li>URL routing and views</li>
                    <li>Django templates and template inheritance</li>
                    <li>Static files handling</li>
                    <li>Django settings and configuration</li>
                </ul>
                <p><strong>Preparation:</strong> Install Python 3.11+ and ensure pip is working.</p>
            </section>

            <section data-slide-title="Questions & Discussion" class="center">
                <h2>Questions & Discussion</h2>
                <p><strong>Contact:</strong> JWilliams@Staff.newman.ac.uk</p>
                <p><strong>Office Hours:</strong> By appointment</p>
                <p><strong>Resources:</strong> MDN Fetch API, JavaScript.info</p>
                <p>Thank you for your attention!</p>
            </section>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/plugin/notes/notes.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/plugin/markdown/markdown.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5.0.4/plugin/highlight/highlight.js"></script>

    <script>
        // Prevent wheel events from changing slides when scrolling
        Reveal.on('ready', () => {
            const scrollableElements = document.querySelectorAll('.reveal pre, .reveal .code-example, .reveal .task-box, .reveal .info-box, .reveal .warning-box');
            
            scrollableElements.forEach(element => {
                element.addEventListener('wheel', (e) => {
                    const atTop = element.scrollTop === 0;
                    const atBottom = element.scrollHeight - element.scrollTop === element.clientHeight;
                    
                    if ((e.deltaY < 0 && !atTop) || (e.deltaY > 0 && !atBottom)) {
                        e.stopPropagation();
                    }
                });
            });
        });

        Reveal.initialize({
            hash: true,
            slideNumber: true,
            transition: 'none',
            backgroundTransition: 'none',
            center: false,
            disableLayout: true,
            plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
        });
    </script>
</body>

</html>
