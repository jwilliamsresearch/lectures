<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMM721 - Session 8: Django REST Framework</title>

    <link rel="stylesheet" href="../../libs/reveal.js/dist/reset.css">
    <link rel="stylesheet" href="../../libs/reveal.js/dist/reveal.css">
    <link rel="stylesheet" href="../../placeholder/academic-theme.css">

    <!-- Syntax highlighting -->
    <link rel="stylesheet" href="../../libs/reveal.js/plugin/highlight/monokai.css">
</head>

<body>
    <div class="slide-nav">
        <a href="../../index.html" title="Home">H</a>
        <a href="../index.html" title="Module Home">M</a>
        <a href="session7.html" title="Previous Session">&lt;</a>
        <a href="session9.html" title="Next Session">&gt;</a>
    </div>
    <div class="reveal">
        <div class="slides">

            <!-- Title Slide -->
            <section class="title-slide" data-slide-title="Title Slide">
                <div class="module-code">CMM721</div>
                <h1>Django REST Framework</h1>
                <h2>Session 8</h2>
                <div class="author">
                    <p><strong>James Williams</strong></p>
                    <p><a href="mailto:jwilliams@staff.newman.ac.uk">jwilliams@staff.newman.ac.uk</a></p>
                </div>
            </section>

            <section data-slide-title="Learning Objectives">
                <h2>Learning Objectives</h2>
                <ul>
                    <li>Understand REST API principles</li>
                    <li>Install and configure Django REST Framework</li>
                    <li>Create serializers for data validation</li>
                    <li>Build API views and viewsets</li>
                    <li>Implement authentication and permissions</li>
                    <li>Test APIs using browsable API and Postman</li>
                </ul>
            </section>

            <section data-slide-title="What is REST?">
                <h2>What is REST?</h2>
                <div class="highlight">
                    <strong>REST:</strong> Representational State Transfer
                </div>
                <h3>Key Principles:</h3>
                <ul>
                    <li><strong>Stateless:</strong> Each request contains all information needed</li>
                    <li><strong>Resource-based:</strong> Everything is a resource with a URI</li>
                    <li><strong>HTTP Methods:</strong> GET, POST, PUT, PATCH, DELETE</li>
                    <li><strong>JSON Format:</strong> Standard data exchange format</li>
                </ul>
                <h3>Example REST API:</h3>
                <div class="api-endpoint">
                    <span class="method-badge method-get">GET</span>
                    <span>https://api.example.com/posts/</span>
                </div>
                <div class="api-endpoint">
                    <span class="method-badge method-post">POST</span>
                    <span>https://api.example.com/posts/</span>
                </div>
            </section>

            <section data-slide-title="Django REST Framework (DRF)">
                <h2>Django REST Framework (DRF)</h2>
                <h3>Installation:</h3>
                <div class="code-example">
                    <pre><code class="language-python"># Install DRF
pip install djangorestframework
# Add to INSTALLED_APPS in settings.py
INSTALLED_APPS = [
...
'rest_framework',
]
# Add REST Framework settings
REST_FRAMEWORK = {
'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
'PAGE_SIZE': 10
}</code></pre>
                </div>
            </section>

            <section data-slide-title="Serializers">
                <h2>Serializers</h2>
                <div class="highlight">
                    <strong>Serializer:</strong> Converts complex data (models) â†” JSON
                </div>
                <div class="code-example">
                    <pre><code class="language-python"># serializers.py
from rest_framework import serializers
from .models import Post
class PostSerializer(serializers.ModelSerializer):
author_name = serializers.CharField(source='author.username', read_only=True)
class Meta:
model = Post
fields = ['id', 'title', 'content', 'author', 'author_name', 'created_at']
read_only_fields = ['id', 'created_at']</code></pre>
                </div>
            </section>

            <section data-slide-title="ðŸŽ¯ Serialization Example">
                <h2>ðŸŽ¯ Serialization Example</h2>
                <div class="demo-container">
                    <h3>Django Model â†’ JSON</h3>
                    <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center;">
                        <div>
                            <h4 style="color: #3498db;">Python Object</h4>
                            <div class="code-example" style="font-size: 0.8em;">
                                post = Post(<br>
                                &nbsp;&nbsp;id=1,<br>
                                &nbsp;&nbsp;title="Django REST",<br>
                                &nbsp;&nbsp;content="API tutorial",<br>
                                &nbsp;&nbsp;author=user<br>
                                )
                            </div>
                        </div>
                        <div style="font-size: 2em; color: #9b59b6;">â†’</div>
                        <div>
                            <h4 style="color: #27ae60;">JSON Response</h4>
                            <div class="json-example">
                                {<br>
                                &nbsp;&nbsp;<span class="json-key">"id"</span>: <span class="json-number">1</span>,<br>
                                &nbsp;&nbsp;<span class="json-key">"title"</span>: <span class="json-string">"Django REST"</span>,<br>
                                &nbsp;&nbsp;<span class="json-key">"content"</span>: <span class="json-string">"API tutorial"</span>,<br>
                                &nbsp;&nbsp;<span class="json-key">"author"</span>: <span class="json-number">5</span>,<br>
                                &nbsp;&nbsp;<span class="json-key">"created_at"</span>: <span class="json-string">"2024-01-15"</span><br>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section data-slide-title="API Views">
                <h2>API Views</h2>
                <h3>Function-Based View:</h3>
                <div class="code-example">
                    <pre><code class="language-python">from rest_framework.decorators import api_view
from rest_framework.response import Response
from rest_framework import status
@api_view(['GET', 'POST'])
def post_list(request):
if request.method == 'GET':
posts = Post.objects.all()
serializer = PostSerializer(posts, many=True)
return Response(serializer.data)
elif request.method == 'POST':
serializer = PostSerializer(data=request.data)
if serializer.is_valid():
serializer.save()
return Response(serializer.data, status=status.HTTP_201_CREATED)
return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)</code></pre>
                </div>
            </section>

            <section data-slide-title="Class-Based Views">
                <h2>Class-Based Views</h2>
                <div class="code-example">
                    <pre><code class="language-python">from rest_framework import generics
class PostListCreate(generics.ListCreateAPIView):
queryset = Post.objects.all()
serializer_class = PostSerializer
class PostDetail(generics.RetrieveUpdateDestroyAPIView):
queryset = Post.objects.all()
serializer_class = PostSerializer</code></pre>
                </div>
                <h3>URL Configuration:</h3>
                <div class="code-example">
                    <pre><code class="language-python">from django.urls import path
from . import views
urlpatterns = [
path('api/posts/', views.PostListCreate.as_view()),
path('api/posts/&lt;int:pk&gt;/', views.PostDetail.as_view()),
]</code></pre>
                </div>
            </section>

            <section data-slide-title="ViewSets and Routers">
                <h2>ViewSets and Routers</h2>
                <div class="code-example">
                    <pre><code class="language-python"># views.py
from rest_framework import viewsets
class PostViewSet(viewsets.ModelViewSet):
queryset = Post.objects.all()
serializer_class = PostSerializer
# urls.py
from rest_framework.routers import DefaultRouter
from . import views
router = DefaultRouter()
router.register(r'posts', views.PostViewSet)
urlpatterns = [
path('api/', include(router.urls)),
]</code></pre>
                </div>
                <div class="highlight">
                    <strong>Result:</strong> Automatic CRUD endpoints with minimal code!
                </div>
            </section>

            <section data-slide-title="ðŸŽ¯ API Endpoint Overview">
                <h2>ðŸŽ¯ API Endpoint Overview</h2>
                <div class="demo-container">
                    <h3>Generated Endpoints</h3>
                    <div class="api-endpoint">
                        <span class="method-badge method-get">GET</span>
                        <span>/api/posts/</span>
                        <span style="color: #7f8c8d; margin-left: auto;">List all posts</span>
                    </div>
                    <div class="api-endpoint">
                        <span class="method-badge method-post">POST</span>
                        <span>/api/posts/</span>
                        <span style="color: #7f8c8d; margin-left: auto;">Create new post</span>
                    </div>
                    <div class="api-endpoint">
                        <span class="method-badge method-get">GET</span>
                        <span>/api/posts/1/</span>
                        <span style="color: #7f8c8d; margin-left: auto;">Retrieve post #1</span>
                    </div>
                    <div class="api-endpoint">
                        <span class="method-badge method-put">PUT</span>
                        <span>/api/posts/1/</span>
                        <span style="color: #7f8c8d; margin-left: auto;">Update post #1</span>
                    </div>
                    <div class="api-endpoint">
                        <span class="method-badge method-delete">DELETE</span>
                        <span>/api/posts/1/</span>
                        <span style="color: #7f8c8d; margin-left: auto;">Delete post #1</span>
                    </div>
                </div>
            </section>

            <section data-slide-title="Task 1: Build REST API">
                <h2>Task 1: Build REST API</h2>
                <div class="task-box">
                    <h3>Objective:</h3>
                    <p>Create a complete REST API for your blog</p>
                    <h3>Requirements:</h3>
                    <ol>
                        <li>Install Django REST Framework</li>
                        <li>Create PostSerializer with all fields</li>
                        <li>Create CommentSerializer</li>
                        <li>Implement ViewSets for Post and Comment</li>
                        <li>Configure router for automatic URL generation</li>
                        <li>Test all endpoints in browsable API</li>
                        <li>Ensure proper JSON responses</li>
                    </ol>
                    <h3>Test Endpoints:</h3>
                    <ul>
                        <li>GET /api/posts/ - List posts</li>
                        <li>POST /api/posts/ - Create post</li>
                        <li>GET /api/posts/1/ - Detail view</li>
                        <li>PUT /api/posts/1/ - Update</li>
                        <li>DELETE /api/posts/1/ - Delete</li>
                    </ul>
                </div>
            </section>

            <section data-slide-title="Authentication">
                <h2>Authentication</h2>
                <h3>Token Authentication:</h3>
                <div class="code-example">
                    <pre><code class="language-python"># settings.py
INSTALLED_APPS = [
...
'rest_framework.authtoken',
]
REST_FRAMEWORK = {
'DEFAULT_AUTHENTICATION_CLASSES': [
'rest_framework.authentication.TokenAuthentication',
]
}
# Generate token for user
from rest_framework.authtoken.models import Token
token = Token.objects.create(user=user)
print(token.key)</code></pre>
                </div>
            </section>

            <section data-slide-title="Permissions">
                <h2>Permissions</h2>
                <div class="code-example">
                    <pre><code class="language-python">from rest_framework import permissions
class PostViewSet(viewsets.ModelViewSet):
queryset = Post.objects.all()
serializer_class = PostSerializer
permission_classes = [permissions.IsAuthenticatedOrReadOnly]
def perform_create(self, serializer):
serializer.save(author=self.request.user)</code></pre>
                </div>
                <h3>Built-in Permissions:</h3>
                <ul>
                    <li><strong>AllowAny:</strong> No restrictions</li>
                    <li><strong>IsAuthenticated:</strong> Must be logged in</li>
                    <li><strong>IsAuthenticatedOrReadOnly:</strong> Read for all, write for authenticated</li>
                    <li><strong>IsAdminUser:</strong> Admin only</li>
                </ul>
            </section>

            <section data-slide-title="Custom Permissions">
                <h2>Custom Permissions</h2>
                <div class="code-example">
                    <pre><code class="language-python">from rest_framework import permissions
class IsAuthorOrReadOnly(permissions.BasePermission):
"""
Custom permission: only author can edit/delete
"""
def has_object_permission(self, request, view, obj):
# Read permissions allowed for any request
if request.method in permissions.SAFE_METHODS:
return True
# Write permissions only for author
return obj.author == request.user
# Usage
class PostViewSet(viewsets.ModelViewSet):
permission_classes = [IsAuthorOrReadOnly]</code></pre>
                </div>
            </section>

            <section data-slide-title="Filtering and Search">
                <h2>Filtering and Search</h2>
                <div class="code-example">
                    <pre><code class="language-python"># Install
pip install django-filter
# Add to INSTALLED_APPS
INSTALLED_APPS = [
...
'django_filters',
]
# ViewSet with filtering
from rest_framework import filters
from django_filters.rest_framework import DjangoFilterBackend
class PostViewSet(viewsets.ModelViewSet):
queryset = Post.objects.all()
serializer_class = PostSerializer
filter_backends = [DjangoFilterBackend, filters.SearchFilter]
filterset_fields = ['author', 'published']
search_fields = ['title', 'content']</code></pre>
                </div>
            </section>

            <section data-slide-title="Task 2: Authentication & Permissions">
                <h2>Task 2: Authentication & Permissions</h2>
                <div class="task-box">
                    <h3>Objective:</h3>
                    <p>Add authentication and authorization to your API</p>
                    <h3>Requirements:</h3>
                    <ol>
                        <li>Implement Token Authentication</li>
                        <li>Create login/logout endpoints</li>
                        <li>Add IsAuthenticatedOrReadOnly to posts</li>
                        <li>Create custom IsAuthorOrReadOnly permission</li>
                        <li>Automatically assign author on post creation</li>
                        <li>Add filtering by author and published status</li>
                        <li>Implement search on title and content</li>
                        <li>Test with authenticated and anonymous users</li>
                    </ol>
                    <h3>Bonus:</h3>
                    <ul>
                        <li>Add user registration endpoint</li>
                        <li>Implement pagination</li>
                        <li>Add ordering by date</li>
                    </ul>
                </div>
            </section>

            <section data-slide-title="ðŸŽ¯ Testing with Browsable API">
                <h2>ðŸŽ¯ Testing with Browsable API</h2>
                <div class="demo-container">
                    <h3>DRF Browsable API Features</h3>
                    <ul style="font-size: 1em;">
                        <li><strong>Interactive Interface:</strong> Test API directly in browser</li>
                        <li><strong>JSON/HTML Toggle:</strong> View responses in different formats</li>
                        <li><strong>Login/Logout:</strong> Built-in authentication UI</li>
                        <li><strong>Forms:</strong> Automatically generated for POST/PUT</li>
                        <li><strong>OPTIONS:</strong> See available actions and fields</li>
                    </ul>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin-top: 15px;">
                        <p style="margin: 0;"><strong>Try it:</strong></p>
                        <code style="color: #9b59b6;">http://127.0.0.1:8000/api/posts/</code>
                    </div>
                </div>
            </section>

            <section data-slide-title="Testing with Postman">
                <h2>Testing with Postman</h2>
                <h3>GET Request:</h3>
                <div class="code-example">
                    <pre><code class="language-http">GET http://127.0.0.1:8000/api/posts/
Headers:
Authorization: Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b</code></pre>
                </div>
                <h3>POST Request:</h3>
                <div class="code-example">
                    <pre><code class="language-http">POST http://127.0.0.1:8000/api/posts/
Headers:
Content-Type: application/json
Authorization: Token 9944b09...
Body:
{
"title": "New Post",
"content": "Post content here",
"published": true
}</code></pre>
                </div>
            </section>

            <section data-slide-title="Nested Serializers">
                <h2>Nested Serializers</h2>
                <div class="code-example">
                    <pre><code class="language-python">class CommentSerializer(serializers.ModelSerializer):
author_name = serializers.CharField(source='author.username', read_only=True)
class Meta:
model = Comment
fields = ['id', 'text', 'author', 'author_name', 'created_at']
class PostSerializer(serializers.ModelSerializer):
comments = CommentSerializer(many=True, read_only=True, source='comment_set')
comment_count = serializers.SerializerMethodField()
class Meta:
model = Post
fields = ['id', 'title', 'content', 'comments', 'comment_count']
def get_comment_count(self, obj):
return obj.comment_set.count()</code></pre>
                </div>
            </section>

            <section data-slide-title="Best Practices">
                <h2>Best Practices</h2>
                <ul>
                    <li><strong>Versioning:</strong> Use API versioning (/api/v1/)</li>
                    <li><strong>Pagination:</strong> Always paginate list endpoints</li>
                    <li><strong>Error Handling:</strong> Return consistent error responses</li>
                    <li><strong>Validation:</strong> Use serializer validation methods</li>
                    <li><strong>Documentation:</strong> Use drf-yasg or drf-spectacular</li>
                    <li><strong>CORS:</strong> Configure django-cors-headers for frontend</li>
                    <li><strong>Throttling:</strong> Implement rate limiting</li>
                    <li><strong>Testing:</strong> Write API tests using APITestCase</li>
                </ul>
                <div class="highlight">
                    <strong>Security:</strong> Always use HTTPS in production!
                </div>
            </section>

            <section data-slide-title="Next Session: React & State Management">
                <h2>Next Session: React & State Management</h2>
                <ul>
                    <li>Introduction to React</li>
                    <li>Components, props, and state</li>
                    <li>React Hooks (useState, useEffect)</li>
                    <li>Fetching data from Django API</li>
                    <li>State management basics</li>
                    <li>Redux fundamentals</li>
                </ul>
                <p><strong>Preparation:</strong> Install Node.js and create-react-app</p>
            </section>

            <section data-slide-title="Questions & Discussion" class="center">
                <h2>Questions & Discussion</h2>
                <p><strong>Contact:</strong> JWilliams@Staff.newman.ac.uk</p>
                <p><strong>Office Hours:</strong> By appointment</p>
                <p><strong>Resources:</strong> DRF Documentation, Postman Learning Center</p>
                <p>Thank you for your attention!</p>
            </section>

        </div>
    </div>

    <script src="../../libs/reveal.js/dist/reveal.js"></script>
    <script src="../../libs/reveal.js/plugin/notes/notes.js"></script>
    <script src="../../libs/reveal.js/plugin/markdown/markdown.js"></script>
    <script src="../../libs/reveal.js/plugin/highlight/highlight.js"></script>

    <script>
        // Prevent wheel events from changing slides when scrolling
        Reveal.on('ready', () => {
            const scrollableElements = document.querySelectorAll('.reveal pre, .reveal .code-example, .reveal .task-box, .reveal .info-box, .reveal .warning-box');
            
            scrollableElements.forEach(element => {
                element.addEventListener('wheel', (e) => {
                    const atTop = element.scrollTop === 0;
                    const atBottom = element.scrollHeight - element.scrollTop === element.clientHeight;
                    
                    if ((e.deltaY < 0 && !atTop) || (e.deltaY > 0 && !atBottom)) {
                        e.stopPropagation();
                    }
                });
            });
        });

        Reveal.initialize({
            hash: true,
            slideNumber: true,
            transition: 'none',
            backgroundTransition: 'none',
            center: false,
            disableLayout: true,
            plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
        });
    </script>
</body>

</html>
