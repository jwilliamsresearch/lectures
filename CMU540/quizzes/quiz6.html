<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz 6: WEB-SQL-01 - SQL Injection - Birmingham Newman University</title>
    <link rel="stylesheet" href="../../base.css">
    <link rel="stylesheet" href="../../placeholder/quiz.css">    <style>
        body {
            max-width: 900px;
            margin: 2em auto;
            padding: 2em;
        }
        
        .quiz-header {
            text-align: center;
            margin-bottom: 3em;
            padding-bottom: 2em;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .quiz-header h1 {
            font-size: 2em;
            margin-bottom: 0.3em;
        }
        
        .quiz-header .subtitle {
            color: #666;
            font-size: 1.1em;
        }
        
        .quiz-info {
            background: #f8f8f8;
            padding: 1.5em;
            margin-bottom: 2em;
            border-left: 3px solid #2c3e50;
        }
        
        .question {
            background: #fff;
            padding: 2em;
            margin-bottom: 2em;
            border: 1px solid #e0e0e0;
        }
        
        .question-number {
            color: #2c3e50;
            font-weight: bold;
            margin-bottom: 1em;
        }
        
        .question-text {
            font-size: 1.1em;
            margin-bottom: 1.5em;
            line-height: 1.6;
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: 0.8em;
        }
        
        .option {
            padding: 1em;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .option:hover {
            background: #f8f8f8;
            border-color: #2c3e50;
        }
        
        .option.selected {
            background: #e8f0f8;
            border-color: #2c3e50;
        }
        
        .option.correct {
            background: #e8f5e9;
            border-color: #4caf50;
            border-width: 2px;
        }
        
        .option.incorrect {
            background: #ffebee;
            border-color: #f44336;
            border-width: 2px;
        }
        
        .explanation {
            margin-top: 1em;
            padding: 1em;
            background: #f0f7ff;
            border-left: 3px solid #2196f3;
            display: none;
        }
        
        .explanation.show {
            display: block;
        }
        
        .submit-container {
            text-align: center;
            margin: 3em 0 2em 0;
        }
        
        .btn {
            padding: 1em 2.5em;
            background: #2c3e50;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.2s;
        }
        
        .btn:hover {
            background: #1a252f;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .results {
            display: none;
            text-align: center;
            padding: 3em;
            background: #f8f8f8;
            border: 1px solid #e0e0e0;
        }
        
        .results.show {
            display: block;
        }
        
        .score {
            font-size: 3em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 0.5em;
        }
        
        .feedback {
            font-size: 1.2em;
            margin-bottom: 2em;
            color: #666;
        }
        
        .results-buttons {
            display: flex;
            gap: 1em;
            justify-content: center;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <div class="quiz-header">
        <h1>Quiz</h1>
        <div class="subtitle">Newman University | CMU540</div>
    </div>
    
    <div class="quiz-info">
        <p><strong>Instructions:</strong> Answer all questions below. Questions are randomized each time. Click "Submit Quiz" when finished to see your results.</p>
    </div>
    
    <div id="quiz-container">
        <!-- Questions will be populated by JavaScript -->
    </div>
    
    <div class="submit-container">
        <button class="btn" id="submitBtn" onclick="submitQuiz()">Submit Quiz</button>
    </div>
    
    <div class="results" id="results">
        <div class="score" id="scoreDisplay"></div>
        <div class="feedback" id="feedback"></div>
        <div class="results-buttons">
            <button class="btn" onclick="location.reload()">Retake Quiz</button>
            <button class="btn" onclick="window.location.href='../index.html'">Back to Module</button>
        </div>
    </div>

    <script>
                                            const questionsData = [
            {
                question: "What is SQL injection?",
                options: [
                    "A type of cross-site scripting",
                    "Inserting malicious SQL code into database queries",
                    "A type of authentication bypass",
                    "A network security protocol"
                ],
                correct: 1,
                explanation: "SQL injection is a code injection technique where malicious SQL statements are inserted into database queries."
            },
            {
                question: "What is the primary cause of SQL injection?",
                options: [
                    "Weak authentication",
                    "Improper input validation",
                    "Weak encryption",
                    "Poor session management"
                ],
                correct: 1,
                explanation: "SQL injection is primarily caused by improper input validation and sanitization."
            },
            {
                question: "What is a prepared statement?",
                options: [
                    "A type of SQL query",
                    "A precompiled SQL statement with parameters",
                    "A type of database table",
                    "A type of database index"
                ],
                correct: 1,
                explanation: "A prepared statement is a precompiled SQL statement with parameters that prevents SQL injection."
            },
            {
                question: "What is parameterized query?",
                options: [
                    "A type of SQL query",
                    "A query with parameters instead of direct values",
                    "A type of database table",
                    "A type of database index"
                ],
                correct: 1,
                explanation: "A parameterized query uses parameters instead of directly embedding user input into SQL statements."
            },
            {
                question: "What is blind SQL injection?",
                options: [
                    "A type of SQL injection that returns visible results",
                    "A type of SQL injection that doesn't return visible results",
                    "A type of SQL injection that uses prepared statements",
                    "A type of SQL injection that uses parameters"
                ],
                correct: 1,
                explanation: "Blind SQL injection doesn't return visible results, making it harder to detect and exploit."
            },
            {
                question: "What is time-based blind SQL injection?",
                options: [
                    "A type of SQL injection that returns visible results",
                    "A type of SQL injection that uses time delays",
                    "A type of SQL injection that uses prepared statements",
                    "A type of SQL injection that uses parameters"
                ],
                correct: 1,
                explanation: "Time-based blind SQL injection uses time delays to determine if queries are successful."
            },
            {
                question: "What is boolean-based blind SQL injection?",
                options: [
                    "A type of SQL injection that returns visible results",
                    "A type of SQL injection that uses boolean conditions",
                    "A type of SQL injection that uses prepared statements",
                    "A type of SQL injection that uses parameters"
                ],
                correct: 1,
                explanation: "Boolean-based blind SQL injection uses boolean conditions to determine if queries are successful."
            },
            {
                question: "What is UNION-based SQL injection?",
                options: [
                    "A type of SQL injection that uses UNION operator",
                    "A type of SQL injection that uses prepared statements",
                    "A type of SQL injection that uses parameters",
                    "A type of SQL injection that uses time delays"
                ],
                correct: 0,
                explanation: "UNION-based SQL injection uses the UNION operator to combine results from different queries."
            },
            {
                question: "What is error-based SQL injection?",
                options: [
                    "A type of SQL injection that uses prepared statements",
                    "A type of SQL injection that uses parameters",
                    "A type of SQL injection that uses error messages",
                    "A type of SQL injection that uses time delays"
                ],
                correct: 2,
                explanation: "Error-based SQL injection uses error messages to extract information from the database."
            },
            {
                question: "What is the primary defense against SQL injection?",
                options: [
                    "Input validation",
                    "Parameterized queries",
                    "Output encoding",
                    "Session management"
                ],
                correct: 1,
                explanation: "Parameterized queries (prepared statements) are the primary defense against SQL injection attacks."
            },
            {
                question: "What is input validation?",
                options: [
                    "A type of SQL query",
                    "Checking and sanitizing user input",
                    "A type of database table",
                    "A type of database index"
                ],
                correct: 1,
                explanation: "Input validation is the process of checking and sanitizing user input to prevent malicious data."
            },
            {
                question: "What is output encoding?",
                options: [
                    "A type of SQL query",
                    "Converting data to a safe format for output",
                    "A type of database table",
                    "A type of database index"
                ],
                correct: 1,
                explanation: "Output encoding converts data to a safe format for output to prevent injection attacks."
            },
            {
                question: "What is the primary risk of SQL injection?",
                options: [
                    "System downtime",
                    "Unauthorized database access",
                    "Performance issues",
                    "Network congestion"
                ],
                correct: 1,
                explanation: "The primary risk of SQL injection is unauthorized access to the database and sensitive data."
            },
            {
                question: "What is a SQL injection payload?",
                options: [
                    "A type of SQL query",
                    "Malicious code used in SQL injection attacks",
                    "A type of database table",
                    "A type of database index"
                ],
                correct: 1,
                explanation: "A SQL injection payload is malicious code used to exploit SQL injection vulnerabilities."
            },
            {
                question: "What is the difference between SQL injection and NoSQL injection?",
                options: [
                    "SQL injection targets SQL databases, NoSQL injection targets NoSQL databases",
                    "They are the same thing",
                    "SQL injection is more dangerous",
                    "NoSQL injection is more dangerous"
                ],
                correct: 0,
                explanation: "SQL injection targets SQL databases, while NoSQL injection targets NoSQL databases like MongoDB."
            }
        ];
        // Shuffle array function
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
        
        // Randomize questions on page load
        const questions = shuffleArray(questionsData);
        let userAnswers = new Array(questions.length).fill(null);
        
        function initQuiz() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = questions.map((q, qIndex) => `
                <div class="question" id="question-${qIndex}">
                    <div class="question-number">Question ${qIndex + 1} of ${questions.length}</div>
                    <div class="question-text">${q.question}</div>
                    <div class="options">
                        ${q.options.map((option, oIndex) => `
                            <div class="option" data-question="${qIndex}" data-option="${oIndex}" onclick="selectOption(${qIndex}, ${oIndex})">
                                ${option}
                            </div>
                        `).join('')}
                    </div>
                    <div class="explanation" id="explanation-${qIndex}">
                        <strong>Explanation:</strong> ${q.explanation || 'No explanation provided.'}
                    </div>
                </div>
            `).join('');
        }
        
        function selectOption(questionIndex, optionIndex) {
            console.log('selectOption called:', questionIndex, optionIndex);
            
            // Deselect all options for this question
            document.querySelectorAll(`[data-question="${questionIndex}"]`).forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Select the clicked option using data attributes
            const selectedOption = document.querySelector(`[data-question="${questionIndex}"][data-option="${optionIndex}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
                console.log('Option selected successfully');
            } else {
                console.log('ERROR: Could not find option element');
            }
            userAnswers[questionIndex] = optionIndex;
            console.log('userAnswers updated:', userAnswers);
        }
        
        function submitQuiz() {
            console.log('submitQuiz called');
            console.log('Current userAnswers:', userAnswers);
            console.log('Questions length:', questions.length);
            
            // Check if all questions are answered
            const unanswered = userAnswers.filter((ans, idx) => ans === null).length;
            console.log('Unanswered count:', unanswered);
            
            if (unanswered > 0) {
                alert(`Please answer all questions before submitting. ${unanswered} question(s) remaining.`);
                console.log('User answers:', userAnswers);
                console.log('Total questions:', questions.length);
                return;
            }
            
            console.log('All questions answered, calculating score...');
            
            // Calculate score
            let correct = 0;
            questions.forEach((q, index) => {
                const isCorrect = userAnswers[index] === q.correct;
                if (isCorrect) correct++;
                
                // Show correct/incorrect
                const options = document.querySelectorAll(`[data-question="${index}"]`);
                options.forEach((opt, oIndex) => {
                    opt.style.cursor = 'default';
                    opt.onclick = null;
                    
                    if (oIndex === q.correct) {
                        opt.classList.add('correct');
                    } else if (oIndex === userAnswers[index]) {
                        opt.classList.add('incorrect');
                    }
                });
                
                // Show explanation
                document.getElementById(`explanation-${index}`).classList.add('show');
            });
            
            // Display results
            const percentage = Math.round((correct / questions.length) * 100);
            document.getElementById('scoreDisplay').textContent = `${correct}/${questions.length} (${percentage}%)`;
            
            let feedbackText = '';
            if (percentage >= 90) {
                feedbackText = 'Excellent work! You have demonstrated mastery of this material.';
            } else if (percentage >= 80) {
                feedbackText = 'Very good! You have a strong understanding of the concepts.';
            } else if (percentage >= 70) {
                feedbackText = 'Good effort. You have grasped the fundamentals.';
            } else if (percentage >= 60) {
                feedbackText = 'Fair performance. Review the material to strengthen your understanding.';
            } else {
                feedbackText = 'Additional study is recommended. Review the session materials carefully.';
            }
            
            document.getElementById('feedback').textContent = feedbackText;
            document.getElementById('results').classList.add('show');
            document.getElementById('submitBtn').disabled = true;
            
            // Scroll to results
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Initialize quiz on page load
        window.onload = initQuiz;
    </script>
</html>
